# ã‚¿ã‚¹ã‚¯ç®¡ç†æ©Ÿèƒ½ è©³ç´°è¨­è¨ˆæ›¸

> **æœ€çµ‚æ›´æ–°**: 2025å¹´12æœˆ16æ—¥
>
> æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€å“ç‰©ç®¡ç†ãƒ»ã‚±ã‚¢æŒ‡ç¤ºã«é–¢é€£ã™ã‚‹ã‚¿ã‚¹ã‚¯ã®è‡ªå‹•ç”Ÿæˆãƒ»ç®¡ç†æ©Ÿèƒ½ã®è©³ç´°è¨­è¨ˆã‚’å®šç¾©ã—ã¾ã™ã€‚

---

## 1. æ¦‚è¦

### 1.1 ç›®çš„

ä»‹è­·æ–½è¨­ã®ã‚¹ã‚¿ãƒƒãƒ•ãŒã€Œä»Šæ—¥ä½•ã‚’ã™ã¹ãã‹ã€ã‚’æ˜ç¢ºã«æŠŠæ¡ã—ã€æ¼ã‚Œãªãå¯¾å¿œã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼š

1. **è³å‘³æœŸé™ç®¡ç†**: æœŸé™ãŒè¿‘ã„å“ç‰©ã®æä¾›ã‚’ä¿ƒã™
2. **æä¾›ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼**: å®¶æ—ã®å¸Œæœ›æä¾›æ—¥ã«åˆã‚ã›ã¦é€šçŸ¥
3. **ã‚±ã‚¢æŒ‡ç¤ºç¢ºèª**: å®¶æ—ã‹ã‚‰ã®æŒ‡ç¤ºã‚’ç¢ºèªãƒ»å¯¾å¿œ
4. **é€²æ—å¯è¦–åŒ–**: ã‚¿ã‚¹ã‚¯ã®å®Œäº†çŠ¶æ³ã‚’å®¶æ—ãƒ»ã‚¹ã‚¿ãƒƒãƒ•ã§å…±æœ‰

### 1.2 ã‚¿ã‚¹ã‚¯ã®ç¨®é¡

| ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ— | ç”Ÿæˆå…ƒ | èª¬æ˜ |
|-------------|--------|------|
| `expiration_warning` | å“ç‰© | è³å‘³æœŸé™ãŒè¿‘ã„å“ç‰©ã®è­¦å‘Š |
| `serve_reminder` | å“ç‰© | æä¾›äºˆå®šæ—¥ã®ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ |
| `restock_alert` | å“ç‰© | åœ¨åº«åˆ‡ã‚Œã‚¢ãƒ©ãƒ¼ãƒˆ |
| `care_instruction` | ã‚±ã‚¢æŒ‡ç¤º | æ–°ã—ã„ã‚±ã‚¢æŒ‡ç¤ºã®ç¢ºèª |
| `custom` | ã‚¹ã‚¿ãƒƒãƒ•/ç®¡ç†è€… | æ‰‹å‹•ä½œæˆã®ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¹ã‚¯ |

### 1.3 ã‚¿ã‚¹ã‚¯ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ã‚¿ã‚¹ã‚¯ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚    [è‡ªå‹•ç”Ÿæˆ]          [ç¢ºèª]           [å®Œäº†]              â”‚
â”‚        â”‚                 â”‚                â”‚                â”‚
â”‚        â–¼                 â–¼                â–¼                â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚    â”‚pendingâ”‚ â”€â”€â”€â”€â”€â”€> â”‚in_progâ”‚ â”€â”€â”€â”€â”€> â”‚completâ”‚           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚        â”‚                 â”‚                                 â”‚
â”‚        â”‚                 â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚cancellâ”‚           â”‚
â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                     [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### 2.1 Taskï¼ˆã‚¿ã‚¹ã‚¯ï¼‰

```typescript
// Firestore: tasks/{taskId}
interface Task {
  // === è­˜åˆ¥æƒ…å ± ===
  id: string;                    // ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDï¼ˆè‡ªå‹•ç”Ÿæˆ UUIDï¼‰
  residentId: string;            // å…¥å±…è€…ID

  // === ã‚¿ã‚¹ã‚¯å†…å®¹ ===
  title: string;                 // ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆå¿…é ˆï¼‰
  description?: string;          // è©³ç´°èª¬æ˜
  taskType: TaskType;            // ã‚¿ã‚¹ã‚¯ç¨®åˆ¥ï¼ˆå¿…é ˆï¼‰

  // === é–¢é€£ãƒ‡ãƒ¼ã‚¿ ===
  relatedItemId?: string;        // é–¢é€£ã™ã‚‹å“ç‰©IDï¼ˆcare_itemsï¼‰
  relatedInstructionId?: string; // é–¢é€£ã™ã‚‹ã‚±ã‚¢æŒ‡ç¤ºIDï¼ˆcare_instructionsï¼‰

  // === ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« ===
  dueDate: string;               // æœŸæ—¥ (YYYY-MM-DD)ï¼ˆå¿…é ˆï¼‰
  dueTime?: string;              // æ™‚åˆ» (HH:mm)

  // === ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ»å„ªå…ˆåº¦ ===
  status: TaskStatus;            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆå¿…é ˆï¼‰
  priority: TaskPriority;        // å„ªå…ˆåº¦ï¼ˆå¿…é ˆï¼‰

  // === æ‹…å½“ãƒ»å®Ÿè¡Œ ===
  assignee?: string;             // æ‹…å½“è€…ï¼ˆã‚¹ã‚¿ãƒƒãƒ•åï¼‰
  completedBy?: string;          // å®Œäº†è€…ï¼ˆã‚¹ã‚¿ãƒƒãƒ•åï¼‰
  completionNote?: string;       // å®Œäº†æ™‚ã®ãƒ¡ãƒ¢

  // === é€šçŸ¥ ===
  notificationSent: boolean;     // é€šçŸ¥é€ä¿¡æ¸ˆã¿ãƒ•ãƒ©ã‚°
  notificationScheduledAt?: Timestamp; // é€šçŸ¥äºˆå®šæ—¥æ™‚

  // === ç”Ÿæˆæƒ…å ± ===
  createdBy?: string;            // ä½œæˆè€…ï¼ˆ'system' or ã‚¹ã‚¿ãƒƒãƒ•åï¼‰
  isAutoGenerated: boolean;      // è‡ªå‹•ç”Ÿæˆãƒ•ãƒ©ã‚°

  // === ãƒ¡ã‚¿æƒ…å ± ===
  createdAt: Timestamp;          // ä½œæˆæ—¥æ™‚
  updatedAt: Timestamp;          // æ›´æ–°æ—¥æ™‚
  completedAt?: Timestamp;       // å®Œäº†æ—¥æ™‚
}
```

### 2.2 åˆ—æŒ™å‹å®šç¾©

```typescript
// ã‚¿ã‚¹ã‚¯ç¨®åˆ¥
type TaskType =
  | 'expiration_warning'  // è³å‘³æœŸé™è­¦å‘Š
  | 'serve_reminder'      // æä¾›ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼
  | 'restock_alert'       // åœ¨åº«åˆ‡ã‚Œã‚¢ãƒ©ãƒ¼ãƒˆ
  | 'care_instruction'    // ã‚±ã‚¢æŒ‡ç¤ºç¢ºèª
  | 'custom';             // ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¹ã‚¯

const TASK_TYPES: { value: TaskType; label: string; icon: string }[] = [
  { value: 'expiration_warning', label: 'è³å‘³æœŸé™', icon: 'â°' },
  { value: 'serve_reminder', label: 'æä¾›äºˆå®š', icon: 'ğŸ½ï¸' },
  { value: 'restock_alert', label: 'åœ¨åº«åˆ‡ã‚Œ', icon: 'ğŸ“¦' },
  { value: 'care_instruction', label: 'ã‚±ã‚¢æŒ‡ç¤º', icon: 'ğŸ“‹' },
  { value: 'custom', label: 'ãã®ä»–', icon: 'ğŸ“' },
];

// ã‚¿ã‚¹ã‚¯ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
type TaskStatus =
  | 'pending'      // æœªç€æ‰‹
  | 'in_progress'  // å¯¾å¿œä¸­
  | 'completed'    // å®Œäº†
  | 'cancelled';   // ã‚­ãƒ£ãƒ³ã‚»ãƒ«

const TASK_STATUSES: { value: TaskStatus; label: string; color: string }[] = [
  { value: 'pending', label: 'æœªç€æ‰‹', color: 'yellow' },
  { value: 'in_progress', label: 'å¯¾å¿œä¸­', color: 'blue' },
  { value: 'completed', label: 'å®Œäº†', color: 'green' },
  { value: 'cancelled', label: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«', color: 'gray' },
];

// å„ªå…ˆåº¦
type TaskPriority =
  | 'low'     // ä½
  | 'medium'  // ä¸­
  | 'high'    // é«˜
  | 'urgent'; // ç·Šæ€¥

const TASK_PRIORITIES: { value: TaskPriority; label: string; color: string; order: number }[] = [
  { value: 'urgent', label: 'ç·Šæ€¥', color: 'red', order: 0 },
  { value: 'high', label: 'é«˜', color: 'orange', order: 1 },
  { value: 'medium', label: 'ä¸­', color: 'yellow', order: 2 },
  { value: 'low', label: 'ä½', color: 'gray', order: 3 },
];
```

---

## 3. ã‚¿ã‚¹ã‚¯è‡ªå‹•ç”Ÿæˆãƒ«ãƒ¼ãƒ«

### 3.1 è³å‘³æœŸé™è­¦å‘Šï¼ˆexpiration_warningï¼‰

**ãƒˆãƒªã‚¬ãƒ¼**: Cloud Schedulerï¼ˆæ¯æ—¥åˆå‰6æ™‚ï¼‰

**ç”Ÿæˆæ¡ä»¶**:
```typescript
// å“ç‰©ã®è³å‘³æœŸé™ãŒ3æ—¥ä»¥å†…ã§ã€ã¾ã æœªæä¾›ã®ã‚‚ã®
const items = await firestore
  .collection('care_items')
  .where('status', '==', 'pending')
  .where('expirationDate', '<=', addDays(today, 3))
  .where('expirationDate', '>=', today)
  .get();
```

**ç”Ÿæˆã‚¿ã‚¹ã‚¯**:
```typescript
{
  title: `ã€æœŸé™æ³¨æ„ã€‘${item.itemName}ã®è³å‘³æœŸé™ãŒè¿‘ã¥ã„ã¦ã„ã¾ã™`,
  description: `è³å‘³æœŸé™: ${item.expirationDate}ï¼ˆæ®‹ã‚Š${daysUntil}æ—¥ï¼‰`,
  taskType: 'expiration_warning',
  relatedItemId: item.id,
  dueDate: item.expirationDate,
  priority: daysUntil <= 1 ? 'urgent' : 'high',
  status: 'pending',
  isAutoGenerated: true,
  createdBy: 'system',
}
```

### 3.2 æä¾›ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ï¼ˆserve_reminderï¼‰

**ãƒˆãƒªã‚¬ãƒ¼**: Cloud Schedulerï¼ˆæ¯æ—¥åˆå‰6æ™‚ï¼‰

**ç”Ÿæˆæ¡ä»¶**:
```typescript
// æä¾›äºˆå®šæ—¥ãŒä»Šæ—¥ã®å“ç‰©ã§ã€ã¾ã æœªæä¾›ã®ã‚‚ã®
const items = await firestore
  .collection('care_items')
  .where('status', '==', 'pending')
  .where('plannedServeDate', '==', today)
  .get();
```

**ç”Ÿæˆã‚¿ã‚¹ã‚¯**:
```typescript
{
  title: `ã€æä¾›äºˆå®šã€‘${item.itemName}ã‚’æä¾›ã—ã¦ãã ã•ã„`,
  description: `æä¾›æ–¹æ³•: ${item.servingMethod}\n${item.servingMethodDetail || ''}`,
  taskType: 'serve_reminder',
  relatedItemId: item.id,
  dueDate: today,
  priority: 'medium',
  status: 'pending',
  isAutoGenerated: true,
  createdBy: 'system',
}
```

### 3.3 åœ¨åº«åˆ‡ã‚Œã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆrestock_alertï¼‰

**ãƒˆãƒªã‚¬ãƒ¼**: å“ç‰©ã®æ®‹æ•°ãŒ0ã«ãªã£ãŸæ™‚ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰

**ç”Ÿæˆæ¡ä»¶**:
```typescript
// æ®‹æ•°ãŒ0ã§ã€åŒã˜å“ç‰©åã®åœ¨åº«ãŒãªã„
if (item.remainingQuantity === 0) {
  const hasStock = await checkSameItemStock(item.itemName, item.residentId);
  if (!hasStock) {
    // ã‚¿ã‚¹ã‚¯ç”Ÿæˆ
  }
}
```

**ç”Ÿæˆã‚¿ã‚¹ã‚¯**:
```typescript
{
  title: `ã€åœ¨åº«åˆ‡ã‚Œã€‘${item.itemName}ãŒãªããªã‚Šã¾ã—ãŸ`,
  description: `ã”å®¶æ—ã«è£œå……ã‚’ãŠé¡˜ã„ã™ã‚‹å ´åˆã¯ç”³ã—é€ã‚Šã‚’ã”è¨˜å…¥ãã ã•ã„`,
  taskType: 'restock_alert',
  relatedItemId: item.id,
  dueDate: today,
  priority: 'low',
  status: 'pending',
  isAutoGenerated: true,
  createdBy: 'system',
}
```

### 3.4 ã‚±ã‚¢æŒ‡ç¤ºç¢ºèªï¼ˆcare_instructionï¼‰

**ãƒˆãƒªã‚¬ãƒ¼**: å®¶æ—ãŒã‚±ã‚¢æŒ‡ç¤ºã‚’ç™»éŒ²ã—ãŸæ™‚ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰

**ç”Ÿæˆã‚¿ã‚¹ã‚¯**:
```typescript
{
  title: `ã€æ–°è¦æŒ‡ç¤ºã€‘${instruction.menuName}ã«é–¢ã™ã‚‹æŒ‡ç¤º`,
  description: instruction.processingDetail,
  taskType: 'care_instruction',
  relatedInstructionId: instruction.id,
  dueDate: instruction.targetDate,
  priority: instruction.priority === 'critical' ? 'urgent' : 'high',
  status: 'pending',
  isAutoGenerated: true,
  createdBy: 'system',
}
```

---

## 4. APIä»•æ§˜

### 4.1 ã‚¿ã‚¹ã‚¯ä¸€è¦§å–å¾— API

```
GET /getTasks
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰**:
```typescript
interface GetTasksRequest {
  residentId?: string;           // å…¥å±…è€…ã§ãƒ•ã‚£ãƒ«ã‚¿
  status?: TaskStatus | TaskStatus[]; // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ•ã‚£ãƒ«ã‚¿
  taskType?: TaskType;           // ã‚¿ã‚¤ãƒ—ã§ãƒ•ã‚£ãƒ«ã‚¿
  priority?: TaskPriority;       // å„ªå…ˆåº¦ã§ãƒ•ã‚£ãƒ«ã‚¿
  dueDate?: string;              // æœŸæ—¥ã§ãƒ•ã‚£ãƒ«ã‚¿
  dueDateRange?: {               // æœŸæ—¥ç¯„å›²ã§ãƒ•ã‚£ãƒ«ã‚¿
    start: string;
    end: string;
  };
  limit?: number;                // å–å¾—ä»¶æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 50ï¼‰
  offset?: number;               // ã‚ªãƒ•ã‚»ãƒƒãƒˆ
  sortBy?: 'dueDate' | 'priority' | 'createdAt'; // ã‚½ãƒ¼ãƒˆé …ç›®
  sortOrder?: 'asc' | 'desc';    // ã‚½ãƒ¼ãƒˆé †
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
interface GetTasksResponse {
  success: boolean;
  data?: {
    tasks: Task[];
    total: number;
    counts: {
      pending: number;
      inProgress: number;
      completed: number;
      overdue: number;  // æœŸé™åˆ‡ã‚Œ
    };
  };
  error?: string;
}
```

**æ¨©é™**: å…¨ãƒ­ãƒ¼ãƒ«ï¼ˆé–²è¦§ï¼‰

### 4.2 ã‚¿ã‚¹ã‚¯è©³ç´°å–å¾— API

```
GET /getTask/:taskId
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
interface GetTaskResponse {
  success: boolean;
  data?: {
    task: Task;
    relatedItem?: CareItem;       // é–¢é€£å“ç‰©
    relatedInstruction?: CareInstruction; // é–¢é€£ã‚±ã‚¢æŒ‡ç¤º
  };
  error?: string;
}
```

**æ¨©é™**: å…¨ãƒ­ãƒ¼ãƒ«ï¼ˆé–²è¦§ï¼‰

### 4.3 ã‚¿ã‚¹ã‚¯æ›´æ–° API

```
PUT /updateTask
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```typescript
interface UpdateTaskRequest {
  taskId: string;
  updates: {
    status?: TaskStatus;
    assignee?: string;
    completionNote?: string;
  };
  completedBy?: string;          // å®Œäº†æ™‚ã«å¿…é ˆ
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
interface UpdateTaskResponse {
  success: boolean;
  data?: {
    taskId: string;
    status: TaskStatus;
    updatedAt: string;
  };
  error?: string;
}
```

**æ¨©é™**: ã‚¹ã‚¿ãƒƒãƒ•ï¼ˆå®Œäº†å‡¦ç†ï¼‰ã€ç®¡ç†è€…

### 4.4 ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¹ã‚¯ä½œæˆ API

```
POST /createTask
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```typescript
interface CreateTaskRequest {
  residentId: string;
  title: string;
  description?: string;
  dueDate: string;
  dueTime?: string;
  priority: TaskPriority;
  assignee?: string;
}
```

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:
```typescript
interface CreateTaskResponse {
  success: boolean;
  data?: {
    taskId: string;
    createdAt: string;
  };
  error?: string;
}
```

**æ¨©é™**: ã‚¹ã‚¿ãƒƒãƒ•ã€ç®¡ç†è€…

### 4.5 ã‚¿ã‚¹ã‚¯å‰Šé™¤ API

```
DELETE /deleteTask
```

**ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**:
```typescript
interface DeleteTaskRequest {
  taskId: string;
}
```

**æ¨©é™**: ç®¡ç†è€…ã®ã¿

---

## 5. UIè¨­è¨ˆ

### 5.1 ã‚¿ã‚¹ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

**è¡¨ç¤ºå ´æ‰€**:
- ã‚¹ã‚¿ãƒƒãƒ•: `/staff` ãƒ›ãƒ¼ãƒ ç”»é¢ä¸Šéƒ¨
- å®¶æ—: `/family` ãƒ›ãƒ¼ãƒ ç”»é¢ä¸Šéƒ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯                    å…¨ã¦è¦‹ã‚‹ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ ğŸ”´ ç·Šæ€¥ (2)  ğŸŸ  é«˜ (3)  ğŸŸ¡ ä¸­ (5)          â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ”´ â° ã€æœŸé™æ³¨æ„ã€‘ã‚­ã‚¦ã‚¤ã®è³å‘³æœŸé™       â”‚ â”‚
â”‚ â”‚      æœŸé™: ä»Šæ—¥ (12/16)                 â”‚ â”‚
â”‚ â”‚      [å®Œäº†ã«ã™ã‚‹]                        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸŸ  ğŸ“‹ ã€æ–°è¦æŒ‡ç¤ºã€‘ã‚­ã‚¦ã‚¤ã«é–¢ã™ã‚‹æŒ‡ç¤º     â”‚ â”‚
â”‚ â”‚      å±±ç”°æ§˜ã‹ã‚‰ã®æŒ‡ç¤º                    â”‚ â”‚
â”‚ â”‚      [è©³ç´°ã‚’è¦‹ã‚‹]                        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸŸ¡ ğŸ½ï¸ ã€æä¾›äºˆå®šã€‘ãƒ—ãƒªãƒ³ã‚’æä¾›          â”‚ â”‚
â”‚ â”‚      äºˆå®š: ä»Šæ—¥                          â”‚ â”‚
â”‚ â”‚      [å®Œäº†ã«ã™ã‚‹]                        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ã‚¿ã‚¹ã‚¯ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆã‚¹ã‚¿ãƒƒãƒ•ç”¨ï¼‰

**ãƒ‘ã‚¹**: `/staff/tasks`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ ã‚¿ã‚¹ã‚¯ä¸€è¦§                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ä»Šæ—¥] [æ˜æ—¥] [ä»Šé€±] [å…¨ã¦]                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æœªç€æ‰‹] [å¯¾å¿œä¸­] [å®Œäº†]  [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ â”€â”€ ç·Šæ€¥ (2) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â° ã‚­ã‚¦ã‚¤ã®è³å‘³æœŸé™ãŒè¿‘ã¥ã„ã¦ã„ã¾ã™      â”‚ â”‚
â”‚ â”‚    æœŸé™: 12/16  å…¥å±…è€…: ç”°ä¸­æ§˜           â”‚ â”‚
â”‚ â”‚    [å¯¾å¿œã™ã‚‹]                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚ â”€â”€ é«˜ (3) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“‹ ã‚­ã‚¦ã‚¤ã«é–¢ã™ã‚‹æŒ‡ç¤º                    â”‚ â”‚
â”‚ â”‚    å±±ç”°æ§˜ã‚ˆã‚Š  å…¥å±…è€…: ç”°ä¸­æ§˜            â”‚ â”‚
â”‚ â”‚    [ç¢ºèªã™ã‚‹]                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚ â”€â”€ ä¸­ (5) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ...                                         â”‚
â”‚                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [è¨˜éŒ²é–²è¦§] [è¨˜éŒ²å…¥åŠ›] [å®¶æ—æŒ‡ç¤º] [çµ±è¨ˆ]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 ã‚¿ã‚¹ã‚¯è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚¿ã‚¹ã‚¯è©³ç´°                          [Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ ğŸ”´ ç·Šæ€¥                                     â”‚
â”‚                                             â”‚
â”‚ â° ã€æœŸé™æ³¨æ„ã€‘ã‚­ã‚¦ã‚¤ã®è³å‘³æœŸé™ãŒ           â”‚
â”‚    è¿‘ã¥ã„ã¦ã„ã¾ã™                           â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€ è©³ç´° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ è³å‘³æœŸé™: 2025/12/16ï¼ˆä»Šæ—¥ï¼‰           â”‚  â”‚
â”‚ â”‚ å…¥å±…è€…: ç”°ä¸­æ§˜                         â”‚  â”‚
â”‚ â”‚ æ®‹æ•°: 3å€‹                              â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚ â”Œâ”€ é–¢é€£å“ç‰© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ ğŸ¥ ã‚­ã‚¦ã‚¤                              â”‚  â”‚
â”‚ â”‚ [å“ç‰©è©³ç´°ã‚’è¦‹ã‚‹]                       â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚ å®Œäº†ãƒ¡ãƒ¢                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æœ¬æ—¥ä¸­ã«æä¾›ã—ã¾ã—ãŸ                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                             â”‚
â”‚      [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]    [å®Œäº†ã«ã™ã‚‹]           â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 ã‚¿ã‚¹ã‚¯ãƒãƒƒã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```typescript
// frontend/src/components/family/TaskBadge.tsx

interface TaskBadgeProps {
  count: number;
  priority?: TaskPriority;
}

function TaskBadge({ count, priority }: TaskBadgeProps) {
  if (count === 0) return null;

  const colorClass = priority
    ? TASK_PRIORITIES.find(p => p.value === priority)?.color
    : 'red';

  return (
    <span className={`task-badge bg-${colorClass}-500`}>
      {count}
    </span>
  );
}
```

---

## 6. é€šçŸ¥è¨­è¨ˆ

### 6.1 é€šçŸ¥ãƒˆãƒªã‚¬ãƒ¼

| ãƒˆãƒªã‚¬ãƒ¼ | é€šçŸ¥å…ˆ | ã‚¿ã‚¤ãƒŸãƒ³ã‚° | å†…å®¹ |
|---------|--------|-----------|------|
| è³å‘³æœŸé™è­¦å‘Š | ã‚¹ã‚¿ãƒƒãƒ• | æ¯æ—¥9:00 | æœ¬æ—¥æœŸé™ã®å“ç‰©ä¸€è¦§ |
| æä¾›ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ | ã‚¹ã‚¿ãƒƒãƒ• | æ¯æ—¥9:00 | æœ¬æ—¥æä¾›äºˆå®šã®å“ç‰©ä¸€è¦§ |
| ã‚±ã‚¢æŒ‡ç¤ºç™»éŒ² | ã‚¹ã‚¿ãƒƒãƒ• | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  | æ–°ã—ã„æŒ‡ç¤ºã®é€šçŸ¥ |
| ã‚¿ã‚¹ã‚¯å®Œäº† | å®¶æ— | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  | æŒ‡ç¤ºãŒå¯¾å¿œå®Œäº†ã—ãŸé€šçŸ¥ |

### 6.2 é€šçŸ¥å†…å®¹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

**è³å‘³æœŸé™è­¦å‘Šï¼ˆPWA Pushé€šçŸ¥ï¼‰**:
```
ã€æœŸé™æ³¨æ„ã€‘æœ¬æ—¥æœŸé™ã®å“ç‰©ãŒã‚ã‚Šã¾ã™
ãƒ»ã‚­ã‚¦ã‚¤ï¼ˆç”°ä¸­æ§˜ï¼‰- æœŸé™: 12/16
ãƒ»ãƒ—ãƒªãƒ³ï¼ˆå±±ç”°æ§˜ï¼‰- æœŸé™: 12/16
```

**ã‚±ã‚¢æŒ‡ç¤ºç™»éŒ²ï¼ˆPWA Pushé€šçŸ¥ï¼‰**:
```
ã€æ–°è¦æŒ‡ç¤ºã€‘å±±ç”°æ§˜ã‹ã‚‰ã‚±ã‚¢æŒ‡ç¤ºãŒå±Šãã¾ã—ãŸ
ç”°ä¸­æ§˜ã®ã‚­ã‚¦ã‚¤ã«é–¢ã™ã‚‹æŒ‡ç¤ºã§ã™ã€‚
å†…å®¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
```

### 6.3 Cloud Schedulerã‚¸ãƒ§ãƒ–

```typescript
// functions/src/functions/taskGenerator.ts

// æ¯æ—¥åˆå‰6æ™‚ã«å®Ÿè¡Œ: ã‚¿ã‚¹ã‚¯è‡ªå‹•ç”Ÿæˆ
export const generateDailyTasks = functions
  .region('asia-northeast1')
  .pubsub.schedule('0 6 * * *')
  .timeZone('Asia/Tokyo')
  .onRun(async (context) => {
    await generateExpirationWarnings();
    await generateServeReminders();
  });

// æ¯æ—¥åˆå‰9æ™‚ã«å®Ÿè¡Œ: é€šçŸ¥é€ä¿¡
export const sendDailyTaskNotifications = functions
  .region('asia-northeast1')
  .pubsub.schedule('0 9 * * *')
  .timeZone('Asia/Tokyo')
  .onRun(async (context) => {
    await sendExpirationNotifications();
    await sendServeReminderNotifications();
  });
```

---

## 7. å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### 7.1 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

```
functions/src/
â”œâ”€â”€ functions/
â”‚   â”œâ”€â”€ tasks.ts               # ã‚¿ã‚¹ã‚¯CRUD API
â”‚   â””â”€â”€ taskGenerator.ts       # ã‚¿ã‚¹ã‚¯è‡ªå‹•ç”Ÿæˆï¼ˆSchedulerï¼‰
â”œâ”€â”€ types/
â”‚   â””â”€â”€ task.ts                # å‹å®šç¾©
â””â”€â”€ services/
    â”œâ”€â”€ taskService.ts         # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
    â””â”€â”€ taskNotificationService.ts # é€šçŸ¥ãƒ­ã‚¸ãƒƒã‚¯
```

### 7.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

```
frontend/src/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ task.ts                # å‹å®šç¾©ãƒ»å®šæ•°
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ staff/
â”‚   â”‚   â””â”€â”€ TaskList.tsx       # ã‚¿ã‚¹ã‚¯ä¸€è¦§ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ family/
â”‚       â””â”€â”€ TaskDashboard.tsx  # ã‚¿ã‚¹ã‚¯ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”œâ”€â”€ components/family/
â”‚   â”œâ”€â”€ TaskCard.tsx           # ã‚¿ã‚¹ã‚¯ã‚«ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ TaskList.tsx           # ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ
â”‚   â”œâ”€â”€ TaskBadge.tsx          # ã‚¿ã‚¹ã‚¯ãƒãƒƒã‚¸
â”‚   â”œâ”€â”€ TaskDetailModal.tsx    # ã‚¿ã‚¹ã‚¯è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«
â”‚   â””â”€â”€ TaskFilters.tsx        # ãƒ•ã‚£ãƒ«ã‚¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useTasks.ts            # ã‚¿ã‚¹ã‚¯ä¸€è¦§å–å¾—
â”‚   â”œâ”€â”€ useTask.ts             # ã‚¿ã‚¹ã‚¯è©³ç´°å–å¾—
â”‚   â”œâ”€â”€ useTaskCounts.ts       # ã‚¿ã‚¹ã‚¯ä»¶æ•°å–å¾—
â”‚   â””â”€â”€ useTaskMutations.ts    # æ›´æ–°ãƒ»å®Œäº†å‡¦ç†
â””â”€â”€ api/
    â””â”€â”€ tasks.ts               # APIå‘¼ã³å‡ºã—é–¢æ•°
```

---

## 8. å‚ç…§è³‡æ–™

- [USER_ROLE_SPEC.md](./USER_ROLE_SPEC.md) - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ãƒ»æ¨©é™è¨­è¨ˆ
- [ITEM_MANAGEMENT_SPEC.md](./ITEM_MANAGEMENT_SPEC.md) - å“ç‰©ç®¡ç†è©³ç´°è¨­è¨ˆ
- [STATS_DASHBOARD_SPEC.md](./STATS_DASHBOARD_SPEC.md) - çµ±è¨ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­è¨ˆ
- [FAMILY_UX_DESIGN.md](./FAMILY_UX_DESIGN.md) - å®¶æ—å‘ã‘UXè¨­è¨ˆ
