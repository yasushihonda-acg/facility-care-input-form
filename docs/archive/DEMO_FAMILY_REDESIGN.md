# 家族向けデモ特化 再設計書

> **作成日**: 2025年12月17日
> **状態**: 実装完了
>
> 本ドキュメントは、デモモードを「家族向け」に特化して再設計する計画を定義します。

---

## 1. 背景・課題

### 1.1 現状の問題

| 問題 | 詳細 |
|------|------|
| **混在** | 家族向け・スタッフ向けが混在し、誰向けのアプリか不明確 |
| **混乱** | ショーケースで家族→スタッフ→家族と視点が変わり混乱 |
| **一貫性欠如** | フッターナビで両方のページを行き来できてしまう |
| **目的不明** | デモを見た人が「このアプリは何のため？」が分かりにくい |

### 1.2 現状のルーティング

```
/demo
├── /showcase           # 混在ツアー（家族→スタッフ→家族）
├── /staff/*            # スタッフ用ページ ← 混乱の原因
├── /family/*           # 家族用ページ
├── /view               # 記録閲覧（共有）
└── /stats              # 統計（共有）
```

### 1.3 現状のショーケースステップ

1. 家族による品物登録 → `/demo/family/items/new`
2. **スタッフ**の家族連絡確認 → `/demo/staff/family-messages` ← 視点変更
3. 品物の提供・摂食記録 → `/demo/staff/family-messages/...` ← スタッフ視点
4. 家族への結果共有 → `/demo/family` ← 視点変更
5. 摂食傾向の確認 → `/demo/stats`
6. 在庫状況の確認 → `/demo/stats`

**問題**: ステップ2-3でスタッフ視点に切り替わり、家族ユーザーが混乱

---

## 2. 再設計方針

### 2.1 基本方針

| 項目 | 方針 |
|------|------|
| **対象ユーザー** | 家族（入居者の家族）がメインターゲット |
| **スタッフ機能** | 別デモ（`/demo/staff-app`）として分離 |
| **ストーリー** | 家族の使い方に沿ったストーリー仕立て |
| **メッセージ** | 「離れて暮らす親御さんのケアを見守れるアプリ」 |

### 2.2 新しいルーティング

```
/demo                    # 家族向けデモのホーム
├── /showcase           # 家族向けガイドツアー
├── /family/*           # 家族用ページ
├── /view               # 記録閲覧
└── /stats              # 統計

/demo/staff-app          # スタッフ向けデモ（将来または別途）
├── /showcase           # スタッフ向けガイドツアー
└── /*                  # スタッフ用ページ
```

### 2.3 削除・移動するルート

| 現在のルート | 対応 |
|--------------|------|
| `/demo/staff` | → `/demo/staff-app` に移動（または一旦無効化） |
| `/demo/staff/*` | → `/demo/staff-app/*` に移動 |

---

## 3. 家族向けショーケース 新ストーリー

### 3.1 コンセプト

**テーマ**: 「離れて暮らす親御さんへの差し入れを、施設スタッフと連携して見守る」

**ストーリー**:
1. 品物を登録（何を持っていくか/送るか）
2. スタッフへの指示を設定（提供方法・禁止事項）
3. 実際の提供状況を確認（タイムライン）
4. 傾向を分析して次回に活かす（統計）

### 3.2 新しいステップ構成

| Step | タイトル | 説明 | パス | ハイライト |
|------|----------|------|------|------------|
| 1 | 品物を登録する | 差し入れ品を登録します | `/demo/family/items/new` | 品物名・数量・期限、保存方法、AIによる入力補助 |
| 2 | 登録した品物を確認 | 現在の品物一覧を確認します | `/demo/family/items` | 在庫状況、期限アラート、カテゴリ別表示 |
| 3 | いつもの指示を設定 | よく使う提供指示を登録します | `/demo/family/presets` | プリセット管理、AI提案保存、禁止ルール |
| 4 | 入居者設定を確認 | 禁止品目などを設定します | `/demo/family/settings/resident` | 禁止ルール設定、スタッフへの警告表示 |
| 5 | 今日の様子を確認 | タイムラインで食事状況を確認 | `/demo/family` | 食事タイムライン、摂食率表示、スタッフメモ |
| 6 | 傾向を分析する | 統計で摂食傾向を確認します | `/demo/stats` | よく食べる/残す品目、カテゴリ別摂食率 |

### 3.3 ステップ詳細

#### Step 1: 品物を登録する
```
ストーリー: 「週末に施設を訪問。お母さんの好きな羊羹を持っていきました」

画面: 品物登録フォーム
- 品物名: 羊羹（虎屋）
- カテゴリ: 和菓子
- 数量: 3本
- 賞味期限: 2025-01-15
- 保存方法: 常温
- 提供方法: 3時のおやつに1本ずつ
- スタッフへのメモ: 小さく切って提供してください

ポイント: AI提案機能で入力がラクラク
```

#### Step 2: 登録した品物を確認
```
ストーリー: 「今どんな品物が施設にあるか確認」

画面: 品物一覧
- 在庫バー表示（残り何個/何本）
- 期限が近い品物にアラート
- カテゴリ別フィルタ

ポイント: 期限切れ防止、在庫把握
```

#### Step 3: いつもの指示を設定
```
ストーリー: 「毎回同じ品物を持っていくので、よく使う指示を保存」

画面: プリセット管理
- よく持っていく品物をプリセット保存
- AI提案をワンクリックで保存
- 「黒砂糖は朝食後に」などのパターン

ポイント: 次回からの入力が簡単に
```

#### Step 4: 入居者設定を確認
```
ストーリー: 「お母さんは甘すぎるお菓子が苦手なので禁止設定」

画面: 入居者設定
- 禁止品目の登録（例: 七福のお菓子）
- スタッフに自動で警告表示

ポイント: 家族の希望をスタッフに確実に伝える
```

#### Step 5: 今日の様子を確認
```
ストーリー: 「今日の食事はどうだったかな？」

画面: 家族ダッシュボード
- 朝食・昼食・夕食のタイムライン
- 摂食率（完食/半分/残した）
- スタッフからのメモ「今日は完食されました！」

ポイント: 離れていても安心
```

#### Step 6: 傾向を分析する
```
ストーリー: 「最近の傾向を見て、次回持っていくものを決めよう」

画面: 統計ダッシュボード
- よく食べる品目 TOP5
- よく残す品目 TOP5
- カテゴリ別摂食率グラフ

ポイント: データに基づいた差し入れ選び
```

---

## 4. UI/UX変更

### 4.1 デモホーム（/demo）の変更

**現状**:
- 「家族向け機能」「スタッフ向け機能」両方のカード表示

**変更後**:
- 「家族向け機能」のみ表示
- 「スタッフ向けデモはこちら」のリンク（目立たない配置）
- キャッチコピー: 「離れて暮らす親御さんのケアを見守る」

### 4.2 ショーケース（/demo/showcase）の変更

**現状**:
- 6ステップ（家族→スタッフ→家族と視点変更）

**変更後**:
- 6ステップ（すべて家族視点）
- ストーリー仕立てで感情移入しやすく
- 「この画面を見る」ボタンで実際の画面へ

### 4.3 フッターナビの変更

**現状**:
- 家族フッター: ホーム / 品物管理 / 記録閲覧 / 統計
- スタッフフッター: 記録閲覧 / 食事入力 / 家族連絡 / 統計

**変更後（/demo内）**:
- 家族フッターのみ表示
- スタッフページへの導線を削除

---

## 5. 実装計画

### Phase 1: ショーケース再設計
1. `DemoShowcase.tsx` のステップを家族視点に変更
2. ストーリー・説明文の更新
3. パスをすべて `/demo/family/*` 系に変更

### Phase 2: デモホーム簡素化
1. `DemoHome.tsx` から「スタッフ向け機能」カードを削除
2. キャッチコピー・説明文を家族向けに変更
3. 「スタッフ向けデモ」への目立たないリンク追加

### Phase 3: ルーティング整理
1. `/demo/staff/*` ルートを `/demo/staff-app/*` に移動（または一旦無効化）
2. フッターナビからスタッフページ導線を削除
3. 必要に応じてリダイレクト設定

### Phase 4: E2Eテスト更新
1. デモナビゲーションテストの更新
2. 新しいショーケースステップのテスト追加
3. 不要なスタッフ関連テストの削除/移動

---

## 6. スタッフ向けデモ（将来）

`/demo/staff-app` として別途実装を検討

| 項目 | 内容 |
|------|------|
| 対象 | 施設スタッフ |
| 目的 | スタッフがどのように使うかのデモ |
| ストーリー | 家族からの連絡確認 → 品物提供 → 記録入力 |
| 優先度 | 低（必要時に実装） |

---

## 7. 承認事項

本設計書の実装前に、以下を確認してください：

- [x] 家族向けに特化する方針でOK
- [x] ショーケースの新ステップ構成でOK
- [x] スタッフ機能は `/demo/staff-app` に分離でOK
- [x] 実装の優先順位（Phase 1から順に実装）でOK

---

## 変更履歴

| 日付 | 変更内容 |
|------|----------|
| 2025-12-17 | 初版作成 |
| 2025-12-17 | 全Phase実装完了（E2Eテスト43件パス） |
