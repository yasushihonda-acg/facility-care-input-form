---
status: archived
scope: data
owner: core-team
last_reviewed: 2025-12-20
---

# Sheet B（実績入力先）構造ドキュメント

> **最終更新**: 2025年12月14日
>
> このドキュメントはSheet B（書き込み専用スプレッドシート）の構造を記録します。

---

## 概要

| 項目 | 値 |
|------|-----|
| **用途** | ケア実績の入力先（書き込み専用） |
| **Sheet ID** | `1OrpUVoDfUECXCTrKOGKLwN_4OQ9dlg7cUTCPGLDGHV0` |
| **URL** | https://docs.google.com/spreadsheets/d/1OrpUVoDfUECXCTrKOGKLwN_4OQ9dlg7cUTCPGLDGHV0/ |
| **必要な権限** | 編集者 |
| **サービスアカウント共有** | ✅ 完了（2025-12-14） |

---

## シート一覧

| # | シート名 | 用途 | レコード数 |
|---|----------|------|------------|
| 1 | フォームの回答 1 | 食事記録の入力先 | - |

---

## シート詳細

### シート: フォームの回答 1

**用途**: Google Formsからの食事記録回答を受け取るシート

#### カラム構成

| # | カラム名 | データ型 | 説明 | 必須 |
|---|----------|----------|------|------|
| 1 | タイムスタンプ | datetime | フォーム送信日時（自動記録） | ○ |
| 2 | あなたの名前は？ | string | スタッフ名 | ○ |
| 3 | ご利用者様のお名前は？ | string | 入居者名 | ○ |
| 4 | 食事はいつのことですか？ | string | 食事の時間帯（朝食/昼食/夕食等） | ○ |
| 5 | 主食の摂取量は何割ですか？ | string | 主食の摂取割合（0〜10割） | - |
| 6 | 副食の摂取量は何割ですか？ | string | 副食の摂取割合（0〜10割） | - |
| 7 | 注入量は何ccですか？ | number | 経管栄養等の注入量(cc) | - |
| 8 | 間食は何を食べましたか？ | string | 間食の内容 | - |
| 9 | 特記事項 | string | 自由記述の特記事項 | - |
| 10 | 重要特記事項集計表に反映させますか？ | boolean | 重要フラグ（はい/いいえ） | - |
| 11 | 施設 | string | 施設名 | ○ |
| 12 | デイ利用有無 | string | デイサービス利用の有無 | - |
| 13 | 注入の種類 | string | 経管栄養の種類 | - |
| 14 | 投稿ID | string | レコードの一意識別子 | ○ |
| 15 | どこのデイサービスですか？ | string | デイサービス施設名 | - |

---

## Sheet A との比較

| 項目 | Sheet A（記録の結果） | Sheet B（実績入力先） |
|------|----------------------|---------------------|
| **用途** | 読み取り専用 | 書き込み専用 |
| **データソース** | Bot連携ハックで生成 | Google Forms / API |
| **シート数** | 11シート | 1シート（現時点） |
| **権限** | 閲覧者 | 編集者 |
| **関連性** | なし | なし（独立） |

---

## フロントエンドUI vs Sheet Bカラム 対照表

フロントエンドの食事入力フォーム（`/input/meal`）とSheet Bカラムの対応関係を示します。

| # | フロントエンドUI (設問ラベル) | Sheet Bカラム名 | カラム位置 | 対応関係 |
|---|------------------------------|-----------------|-----------|----------|
| 1 | 入力者（あなた）は？ | あなたの名前は？ | B列 (2) | ✅ 対応 |
| 2 | 利用者様のお住まいの施設は？ | 施設 | K列 (11) | ✅ 対応 |
| 3 | 利用者名は？ | ご利用者様のお名前は？ | C列 (3) | ✅ 対応 |
| 4 | デイサービスの利用中ですか？ | デイ利用有無 | L列 (12) | ✅ 対応 |
| 5 | どこのデイサービスですか？ ※条件付き | どこのデイサービスですか？ | O列 (15) | ✅ 対応 |
| 6 | 食事はいつのことですか？ | 食事はいつのことですか？ | D列 (4) | ✅ 対応 |
| 7 | 主食の摂取量は何割ですか？ | 主食の摂取量は何割ですか？ | E列 (5) | ✅ 対応 |
| 8 | 副食の摂取量は何割ですか？ | 副食の摂取量は何割ですか？ | F列 (6) | ✅ 対応 |
| 9 | 注入の種類は？ | 注入の種類 | M列 (13) | ✅ 対応 |
| 10 | 注入量は？ | 注入量は何ccですか？ | G列 (7) | ✅ 対応 |
| 11 | 間食は何を食べましたか？ | 間食は何を食べましたか？ | H列 (8) | ✅ 対応 |
| 12 | 特記事項 | 特記事項 | I列 (9) | ✅ 対応 |
| 13 | 重要特記事項集計表に反映させますか？ | 重要特記事項集計表に反映させますか？ | J列 (10) | ✅ 対応 |
| 14 | 写真アップロード | (Google Drive保存) | - | ✅ 対応 |
| - | (自動生成) | タイムスタンプ | A列 (1) | システム自動 |
| - | (自動生成) | 投稿ID | N列 (14) | システム自動 |

### 対照表サマリー

| 状態 | 件数 |
|------|------|
| ✅ 対応済み | 14項目 |
| システム自動 | 2項目 |
| ⚠️ 未実装 | 0項目 |

### 条件付き表示フィールド

| フィールド | 表示条件 | 入力タイプ | 必須 |
|-----------|---------|-----------|------|
| どこのデイサービスですか？ | 「デイサービスの利用中ですか？」= 「利用中」 | ドロップダウン | ○（条件付き必須） |

---

## API実装メモ

### submitMealRecord エンドポイント

`POST /submitMealRecord` でSheet Bに書き込む際のマッピング:

```typescript
// フロントエンドからの入力 → Sheet Bカラム
{
  staffName: string,        // → あなたの名前は？
  residentName: string,     // → ご利用者様のお名前は？
  mealTime: string,         // → 食事はいつのことですか？
  mainDishRatio: string,    // → 主食の摂取量は何割ですか？
  sideDishRatio: string,    // → 副食の摂取量は何割ですか？
  injectionAmount: number,  // → 注入量は何ccですか？
  snack: string,            // → 間食は何を食べましたか？（※下記参照）
  note: string,             // → 特記事項
  isImportant: boolean,     // → 重要特記事項集計表に反映させますか？
  facility: string,         // → 施設
  dayServiceUsage: string,  // → デイ利用有無
  injectionType: string,    // → 注入の種類
  dayServiceName: string,   // → どこのデイサービスですか？
  snackRecords?: SnackRecord[], // → snackフィールドに自動連結（間食記録連携）
}
// タイムスタンプ、投稿ID は自動生成
```

### snack フィールド書き込みルール（間食記録連携）

`snackRecords[]` がある場合、自動的に `snack` フィールドに連結されます。

| 入力パターン | Sheet B「間食は何を食べましたか？」に書き込まれる内容 |
|-------------|------------------------------------------------|
| `snackRecords[]` のみ | `黒豆 1g（完食）、らっきょう 0.7瓶（ほぼ完食）` |
| `snack`（自由記入）のみ | `施設のおやつも少々` |
| **両方入力** | `黒豆 1g（完食）、らっきょう 0.7瓶（ほぼ完食）。施設のおやつも少々` |

**連結形式**: `{snackRecordsから自動生成}。{snack自由記入}`

**注意**: `snackRecords[].noteToFamily`（家族へのメモ）はSheet Bには反映されません（Firestoreの消費ログにのみ保存）。

詳細は [SNACK_RECORD_INTEGRATION_SPEC.md](./SNACK_RECORD_INTEGRATION_SPEC.md) セクション2.2 参照。

---

## 実装ステータス

| 項目 | 状態 | 備考 |
|------|------|------|
| サービスアカウント共有 | ✅ 完了 | 2025-12-14 |
| API接続確認 | ✅ 完了 | 読み取り・書き込み可能 |
| バックエンド実装 | ✅ 完了 | 間食記録連携含む |
| フロントエンドUI | ✅ 完了 | `/input/meal` で実装済み |
| 間食記録連携 | ✅ 完了 | snackRecords → snack連結ロジック |

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-12-18 | snackフィールド書き込みルール追加（間食記録連携） |
| 2025-12-14 | フロントエンドUI vs Sheet Bカラム対照表を追加 |
| 2025-12-14 | サービスアカウント共有完了、API接続確認済み |
| 2025-12-14 | 初版作成（シート構造分析） |
