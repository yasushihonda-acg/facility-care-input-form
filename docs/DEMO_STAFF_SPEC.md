# Phase 14: スタッフ用デモページ設計書

> **作成日**: 2025年12月19日
> **Phase**: 14.0 - 14.3
> **目的**: スタッフ向けデモ機能の実装

---

## 1. 概要

### 1.1 背景

現在のデモページ（`/demo/*`）は家族向けに特化している。スタッフ向けのデモが存在しないため、以下の課題がある：

- スタッフがアプリの使い方を体験できない
- 家族→スタッフの連携フローを確認できない
- 営業・プレゼン時にスタッフ側のデモができない

### 1.2 解決策

スタッフ用デモページ（`/demo/staff/*`）を新設し、家族用と同じシードデータを共有することで：

- **効率性**: データ重複を避け、一貫性のあるデモ体験
- **リアリティ**: 家族が送った品物をスタッフが確認・記録する自然なフロー
- **完全性**: 家族・スタッフ両方の視点でアプリを体験可能

### 1.3 シードデータ共有の考え方

```
家族が登録（demoCareItems）
    ↓
スタッフが確認（/demo/staff/family-messages）
    ↓
スタッフが記録（/demo/staff/input/meal）
    ↓
消費ログ（demoConsumptionLogs）
    ↓
家族が確認（/demo/family）
```

---

## 2. Phase分割

| Phase | 内容 | 状態 |
|-------|------|------|
| **14.1** | ルート有効化・DemoStaffHome実装 | 未着手 |
| **14.2** | スタッフ用ショーケース実装 | 未着手 |
| **14.3** | フッター・ナビゲーション調整 | 未着手 |

---

## 3. 機能仕様

### 3.1 スタッフ用デモルート

| パス | コンポーネント | 説明 |
|------|----------------|------|
| `/demo/staff` | `DemoStaffHome` | スタッフ用デモホーム（新規） |
| `/demo/staff/showcase` | `DemoStaffShowcase` | スタッフ用ガイドツアー（新規） |
| `/demo/staff/input/meal` | `MealInputPage` | 食事記録入力（既存・有効化済み） |
| `/demo/staff/family-messages` | `FamilyMessages` | 家族連絡一覧（既存・有効化） |
| `/demo/staff/family-messages/:id` | `FamilyMessageDetail` | 家族連絡詳細（既存・有効化） |

### 3.2 DemoStaffHome（新規）

**ファイル**: `frontend/src/pages/demo/DemoStaffHome.tsx`

**レイアウト**:
```
┌─────────────────────────────────────┐
│ ヘッダー「スタッフ用デモ」          │
├─────────────────────────────────────┤
│                                     │
│  👨‍⚕️ ようこそ、スタッフ用デモへ    │
│                                     │
│  ┌─────────────┐ ┌─────────────┐   │
│  │ 📋          │ │ 🍽️          │   │
│  │ 家族連絡    │ │ 食事記録    │   │
│  │ を確認      │ │ を入力      │   │
│  └─────────────┘ └─────────────┘   │
│                                     │
│  ┌─────────────┐ ┌─────────────┐   │
│  │ 📊          │ │ 📖          │   │
│  │ 統計        │ │ 記録閲覧    │   │
│  └─────────────┘ └─────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 🎯 ガイド付きツアーを開始   │   │
│  └─────────────────────────────┘   │
│                                     │
├─────────────────────────────────────┤
│ フッター（スタッフ用）              │
└─────────────────────────────────────┘
```

**機能カード**:

| カード | リンク先 | 説明 |
|--------|----------|------|
| 家族連絡を確認 | `/demo/staff/family-messages` | 家族から送られた品物を確認 |
| 食事記録を入力 | `/demo/staff/input/meal` | 食事・間食の記録を入力 |
| 統計 | `/demo/stats` | 統計ダッシュボード |
| 記録閲覧 | `/demo/view` | 過去の記録を閲覧 |

### 3.3 DemoStaffShowcase（新規）

**ファイル**: `frontend/src/pages/demo/DemoStaffShowcase.tsx`

**ガイドツアー（4ステップ・スタッフ視点）**:

| Step | タイトル | パス | 説明 |
|------|----------|------|------|
| 1 | 家族連絡を確認 | `/demo/staff/family-messages` | 家族が送った品物・指示を確認 |
| 2 | 品物の詳細を見る | `/demo/staff/family-messages/{id}` | 品物詳細・禁止警告を確認 |
| 3 | 食事記録を入力 | `/demo/staff/input/meal` | 食事・間食の記録を入力 |
| 4 | 統計を確認 | `/demo/stats` | 摂食傾向や在庫状況を確認 |

**ストーリー**:
> あなたは介護施設のスタッフです。
> 家族から送られた品物を確認し、入居者様にお届けした記録をつけましょう。
> 記録は家族にも共有され、安心につながります。

### 3.4 フッター表示ルール

| パス | フッター種類 | ナビゲーション項目 |
|------|-------------|-------------------|
| `/demo/staff/*` | スタッフ用 | 記録閲覧 / 記録入力 / 家族連絡 / 統計 |
| `/demo/family/*` | 家族用 | ホーム / 品物管理 / 記録閲覧 / 統計 |
| `/demo`（ホーム） | 非表示 or 両方選択可 | - |

**リンク先（スタッフフッター in /demo/staff/*）**:

| タブ | リンク先 |
|------|----------|
| 記録閲覧 | `/demo/view` |
| 記録入力 | `/demo/staff/input/meal` |
| 家族連絡 | `/demo/staff/family-messages` |
| 統計 | `/demo/stats` |

### 3.5 ヘッダーボタン（ツアーナビゲーション）

`/demo/staff/*` ページ（`/demo/staff/showcase` 除く）では、ヘッダー右側に「← ツアーTOPに戻る」ボタンを表示。

リンク先: `/demo/staff/showcase`

---

## 4. 共有シードデータ

既存のシードデータをそのまま利用。追加・変更なし。

| ファイル | 内容 | スタッフデモでの用途 |
|----------|------|---------------------|
| `demoCareItems.ts` | 品物15件 | 家族連絡一覧に表示 |
| `demoConsumptionLogs.ts` | 消費ログ18件 | 品物タイムラインに表示 |
| `demoTasks.ts` | タスク9件 | （スタッフ向けタスク表示用・将来） |
| `demoStats.ts` | 統計 | 統計ダッシュボードに表示 |
| `demoFoodMasters.ts` | 食品マスタ15件 | AI提案キャッシュ |

---

## 5. E2Eテスト仕様

### 5.1 テストファイル

`frontend/e2e/demo-staff.spec.ts`（新規）

### 5.2 テストケース

| ID | カテゴリ | テスト内容 |
|----|----------|-----------|
| STAFF-001 | ホーム | スタッフ用デモホームが表示される |
| STAFF-002 | ホーム | 4つの機能カードが表示される |
| STAFF-003 | ホーム | ガイドツアーボタンが表示される |
| STAFF-010 | ナビ | 家族連絡カードをクリック→一覧ページへ遷移 |
| STAFF-011 | ナビ | 食事記録カードをクリック→入力ページへ遷移 |
| STAFF-012 | ナビ | 統計カードをクリック→統計ページへ遷移 |
| STAFF-013 | ナビ | 記録閲覧カードをクリック→閲覧ページへ遷移 |
| STAFF-020 | ツアー | ショーケースページが表示される |
| STAFF-021 | ツアー | 4つのステップが表示される |
| STAFF-022 | ツアー | Step 1クリック→家族連絡一覧へ遷移 |
| STAFF-030 | 連絡 | 家族連絡一覧に品物が表示される |
| STAFF-031 | 連絡 | 品物クリック→詳細ページへ遷移（デモ内） |
| STAFF-032 | 連絡 | 禁止品目に警告バッジが表示される |
| STAFF-040 | フッター | /demo/staff/*でスタッフフッターが表示される |
| STAFF-041 | フッター | フッターからデモページ内へ正しく遷移 |
| STAFF-050 | ヘッダー | ツアーTOPに戻るボタンが表示される |
| STAFF-051 | ヘッダー | ボタンクリック→ショーケースへ遷移 |

---

## 6. 実装ファイル一覧

### 6.1 新規作成

| ファイル | 説明 |
|----------|------|
| `frontend/src/pages/demo/DemoStaffHome.tsx` | スタッフ用デモホーム |
| `frontend/src/pages/demo/DemoStaffShowcase.tsx` | スタッフ用ガイドツアー |
| `frontend/e2e/demo-staff.spec.ts` | E2Eテスト |

### 6.2 修正

| ファイル | 修正内容 |
|----------|----------|
| `frontend/src/App.tsx` | スタッフデモルート有効化 |
| `frontend/src/components/FooterNav.tsx` | `/demo/staff/*`判定追加 |
| `frontend/src/components/demo/DemoHeaderButton.tsx` | `/demo/staff/showcase`対応 |
| `frontend/src/pages/demo/DemoHome.tsx` | スタッフデモへのリンク追加 |

---

## 7. デモモード書き込み安全対策

スタッフデモでも家族デモと同様に、書き込み操作は実際には保存されない。

| ページ | 操作 | デモ時の動作 |
|--------|------|-------------|
| FamilyMessages | - | 読み取りのみ（安全） |
| FamilyMessageDetail | 消費記録入力 | アラート表示、実際は保存しない |
| MealInputPage | 食事記録入力 | アラート表示、実際は保存しない |

既存の `useDemoMode` フックで判定し、API呼び出しをスキップする実装は既に完了済み。

---

## 8. 確認チェックリスト

### 8.1 実装前チェック
- [ ] 設計書レビュー完了
- [ ] E2Eテストスケルトン作成

### 8.2 Phase 14.1 完了チェック
- [ ] ルート有効化
- [ ] DemoStaffHome実装
- [ ] E2Eテスト（STAFF-001〜013）パス

### 8.3 Phase 14.2 完了チェック
- [ ] DemoStaffShowcase実装
- [ ] E2Eテスト（STAFF-020〜022）パス

### 8.4 Phase 14.3 完了チェック
- [ ] フッター判定修正
- [ ] ヘッダーボタン対応
- [ ] E2Eテスト（STAFF-030〜051）パス

### 8.5 リリース前チェック
- [ ] 全E2Eテストパス（既存144件 + 新規17件）
- [ ] 本番デプロイ成功
- [ ] 本番サイトで動作確認
- [ ] ドキュメント更新（CURRENT_STATUS.md等）
- [ ] Git push完了

---

## 9. 参考資料

- [DEMO_SHOWCASE_SPEC.md](./DEMO_SHOWCASE_SPEC.md) - 家族向けデモ設計
- [DEMO_FAMILY_REDESIGN.md](./DEMO_FAMILY_REDESIGN.md) - 家族向け特化リデザイン
- [VIEW_ARCHITECTURE_SPEC.md](./VIEW_ARCHITECTURE_SPEC.md) - View構成設計
