# フッターナビゲーション設計書

> **ステータス**: ✅ Phase 8 拡張完了
> **作成日**: 2025-12-14
> **更新日**: 2025-12-16
> **関連**: [USER_ROLE_SPEC.md](./USER_ROLE_SPEC.md), [MEAL_INPUT_FORM_SPEC.md](./MEAL_INPUT_FORM_SPEC.md)

---

## 概要

モバイルUXを改善するため、FABボタン方式からフッターナビゲーション方式に変更。
Phase 8でロール別（スタッフ/家族）のフッターナビゲーションを実装し、各ユーザーに最適化されたUIを提供する。

---

## 現状の課題

### FABボタン方式の問題点

| 問題 | 詳細 |
|------|------|
| 発見性が低い | 右下のFABボタンは目立たず、初見ユーザーは入力方法がわからない |
| 操作性が悪い | 画面右下は片手操作時に親指が届きにくい（特に大画面スマホ） |
| コンテキストが曖昧 | 「閲覧中」か「入力中」かが視覚的に不明確 |
| 拡張性が低い | 入力フォームが増えた場合、FABメニューが煩雑になる |

### ターゲットユーザー特性

- 介護スタッフ（20代〜60代）
- 業務中にスマホで素早く入力したい
- ITリテラシーは様々
- 手袋をしていることもある（タッチ精度低下）

---

## 設計方針

### 1. 完全なビュー分離

```
アプリ構成
├── 閲覧ビュー (/view)      ← 読み取り専用
│   └── 記録一覧（シート別タブ）
│
└── 入力ビュー (/input/meal) ← 書き込み専用
    └── 食事記録入力フォーム

※ 現時点では食事入力のみ実装
※ 将来: 水分/排泄/バイタル/特記事項を追加可能
```

### 2. フッターナビゲーション（ロール別4タブ）

画面下部に固定表示のナビゲーションバーを配置。ロールに応じて異なるタブを表示。

**スタッフ用フッター**（デフォルト）:
```
┌──────────────────────────────────────────────────────┐
│                     [Header]                          │
├──────────────────────────────────────────────────────┤
│               [メインコンテンツ]                       │
├──────────────────────────────────────────────────────┤
│ 📋 記録閲覧 │ ✏️ 記録入力 │ 👨‍👩‍👧 家族連絡 │ 📊 統計 │
└──────────────────────────────────────────────────────┘
```

**家族用フッター**（`/family` パス）:
```
┌──────────────────────────────────────────────────────┐
│                     [Header]                          │
├──────────────────────────────────────────────────────┤
│               [メインコンテンツ]                       │
├──────────────────────────────────────────────────────┤
│ 🏠 ホーム │ 📦 品物管理 │ 📝 ケア指示 │ 📊 統計 │
└──────────────────────────────────────────────────────┘
```

### 3. UX最適化: 直接遷移

**設計判断**: 中間メニュー画面（InputPage）を廃止し、フッターから直接入力フォームへ遷移。

**理由**:
- 現時点で食事入力のみ → 1タップ余分になるメニュー画面は不要
- ユーザビリティ向上: タップ数を最小化
- 将来入力種別が増えた場合はメニュー画面を復活可能

```
フッター「記録入力」タップ
        ↓
   直接 /input/meal へ遷移
        ↓
   食事入力フォーム表示
```

---

## UI仕様

### フッターナビゲーション

| 項目 | 仕様 |
|------|------|
| 高さ | 56px（iOS Safe Area考慮で +34px） |
| 背景色 | white |
| 境界線 | 上部に `border-t border-gray-200` |
| 影 | `shadow-lg` |
| 位置 | `fixed bottom-0` |

### ナビアイテム

| 項目 | 仕様 |
|------|------|
| タッチターゲット | 最小 48x48px |
| アイコンサイズ | 24px (w-6 h-6) |
| ラベルサイズ | 12px (text-xs font-bold) |
| **アクティブ状態** | `bg-primary text-white` (色反転) |
| **非アクティブ状態** | `bg-white text-gray-500` |
| ホバー | `hover:bg-gray-50` |
| トランジション | `transition-all duration-200` |

### アクティブ状態の視覚強調

選択中のタブを明確にするため、**色反転**デザインを採用:

```
非アクティブ: 白背景 + グレー文字/アイコン
アクティブ:   Primary背景 + 白文字/アイコン + 上部インジケーター
```

これにより、現在どのビューにいるかが一目で分かる。

### Safe Area対応

```css
/* iOS Safari 対応 */
padding-bottom: env(safe-area-inset-bottom, 0);
```

---

## ルーティング設計

### 変更前

| パス | コンポーネント | 説明 |
|------|----------------|------|
| `/` | HomePage | 記録閲覧 + FABボタン |
| `/input/meal` | MealInputPage | 食事入力フォーム |

### 変更後（Phase 8 実装済み）

**スタッフ用ルート**:
| パス | コンポーネント | 説明 |
|------|----------------|------|
| `/` | リダイレクト → `/view` | - |
| `/view` | ViewPage | 記録閲覧ビュー（読み取り専用） |
| `/input/meal` | MealInputPage | 食事入力フォーム（書き込み専用） |
| `/staff/family-messages` | FamilyMessagesPage | 家族連絡一覧（読み取り専用） |
| `/staff/family-messages/:id` | FamilyMessageDetailPage | 連絡詳細・対応記録入力 |
| `/staff/stats` | StatsDashboard | 統計ダッシュボード |

**家族用ルート**:
| パス | コンポーネント | 説明 |
|------|----------------|------|
| `/family` | FamilyDashboard | 家族ホーム（タイムライン） |
| `/family/items` | ItemManagement | 品物一覧・在庫状況 |
| `/family/items/new` | ItemForm | 品物登録フォーム |
| `/family/items/:id` | ItemDetailPage | 品物詳細 |
| `/family/request` | RequestBuilder | ケア指示作成 |
| `/family/stats` | StatsDashboard | 統計ダッシュボード |

### 将来拡張（未実装）

| パス | コンポーネント | 説明 |
|------|----------------|------|
| `/input/hydration` | HydrationInputPage | 水分入力フォーム |
| `/input/excretion` | ExcretionInputPage | 排泄入力フォーム |
| `/input/vital` | VitalInputPage | バイタル入力フォーム |
| `/input/note` | NoteInputPage | 特記事項入力フォーム |

---

## コンポーネント設計

### 実装済みコンポーネント

| コンポーネント | 役割 | ファイルパス |
|----------------|------|-------------|
| `FooterNav.tsx` | フッターナビゲーション（ロール別4タブ） | `frontend/src/components/FooterNav.tsx` |
| `Layout.tsx` | 共通レイアウト（Main + FooterNav） | `frontend/src/components/Layout.tsx` |
| `ViewPage.tsx` | 記録閲覧ビュー（FAB削除済み） | `frontend/src/pages/ViewPage.tsx` |

### ロール別フッタータブ設計

**スタッフ用（4タブ）**:
| タブ名 | アイコン | リンク先 | 説明 |
|--------|---------|---------|------|
| 記録閲覧 | 📋 | `/view` | ケア記録の閲覧 |
| 記録入力 | ✏️ | `/input/meal` | 食事記録の入力 |
| 家族連絡 | 👨‍👩‍👧 | `/staff/family-messages` | 家族からの連絡・指示を確認 |
| 統計 | 📊 | `/staff/stats` | 統計ダッシュボード |

**家族用（4タブ）**:
| タブ名 | アイコン | リンク先 | 説明 |
|--------|---------|---------|------|
| ホーム | 🏠 | `/family` | タイムライン・お知らせ |
| 品物管理 | 📦 | `/family/items` | 送付品物の管理 |
| ケア指示 | 📝 | `/family/request` | ケア指示の作成 |
| 統計 | 📊 | `/family/stats` | 統計ダッシュボード |

### フッター切り替えロジック

```typescript
// FooterNav.tsx - URLパスでロールを判定
const isFamilyPath = location.pathname.startsWith('/family');

if (isFamilyPath) {
  // 家族用フッター表示
} else {
  // スタッフ用フッター表示（デフォルト）
}
```

### 変更済みコンポーネント

| コンポーネント | 変更内容 |
|----------------|----------|
| `App.tsx` | ルーティング変更（/view, /input/meal） |
| `MealInputPage.tsx` | Layout適用、戻るボタン追加 |

### 削除済み（UX最適化により不要）

| コンポーネント | 削除理由 |
|----------------|----------|
| `InputPage.tsx` | 食事入力のみのため中間メニュー不要 |
| `InputCard.tsx` | InputPage削除に伴い不要 |

---

## 実装履歴

### Phase 6.0: フッターナビゲーション実装 ✅ 完了

1. ✅ `Layout.tsx` 作成（Main + FooterNav）
2. ✅ `FooterNav.tsx` 作成（2タブ、色反転デザイン）
3. ✅ `ViewPage.tsx` 作成（HomePage.tsxベース、FAB削除）
4. ✅ `App.tsx` ルーティング変更
5. ✅ iOS Safe Area 対応
6. ✅ `MealInputPage.tsx` Layout適用

### UX最適化による変更 ✅

1. ✅ `InputPage.tsx` 削除（中間メニュー不要）
2. ✅ フッターから直接 `/input/meal` へ遷移
3. ✅ アクティブタブの色反転デザイン実装

### Phase 6.2: 追加入力フォーム（将来・未実装）

1. 水分入力フォーム
2. 排泄入力フォーム
3. バイタル入力フォーム
4. 特記事項入力フォーム

※ 複数入力種別が必要になった時点で InputPage を復活

---

## デザイントークン

### フッター用

```css
/* index.css @theme に追加 */
--footer-height: 56px;
--footer-height-safe: calc(56px + env(safe-area-inset-bottom, 0));
--footer-bg: #ffffff;
--footer-border: #e5e7eb;
--footer-active: var(--color-primary);
--footer-inactive: #6b7280;
```

---

## アクセシビリティ

| 項目 | 対応 |
|------|------|
| タッチターゲット | 48x48px 以上 ✅ |
| コントラスト比 | 4.5:1 以上 ✅ |
| role="navigation" | フッターに設定 ✅ |
| aria-label | 「メインナビゲーション」設定 ✅ |

---

## 参考: 類似アプリのナビゲーション

| アプリ | ナビ方式 | タブ数 |
|--------|----------|--------|
| LINE | フッター5タブ | ホーム/トーク/VOOM/ニュース/ウォレット |
| Instagram | フッター5タブ | ホーム/検索/リール/ショップ/プロフィール |
| Twitter/X | フッター5タブ | ホーム/検索/スペース/通知/DM |
| 介護記録アプリ（一般） | フッター3-4タブ | 記録/入力/設定 など |

→ **2タブ構成**はシンプルで迷いにくい

---

## 完了サマリー

- [x] ユーザー承認（2025-12-14）
- [x] Phase 6.0 実装完了（2025-12-14）
- [x] UX最適化（中間メニュー削除）
- [x] Firebase Hosting デプロイ待ち
