# 食事入力フォーム設計書

> **最終更新**: 2025年12月14日
>
> このドキュメントはPWAの食事入力フォームの設計仕様を定義します。

---

## 概要

| 項目 | 値 |
|------|-----|
| **フォーム名** | 食事 |
| **用途** | 介護スタッフが利用者の食事摂取状況を記録 |
| **出力先** | Sheet B（実績入力先） |
| **対象シート** | フォームの回答 1 |

---

## フォームフィールド一覧

| # | フィールド名 | 入力タイプ | 必須 | 選択肢/制約 | Sheet Bカラム |
|---|-------------|-----------|------|------------|---------------|
| 1 | 入力者（あなた）は？ | テキスト入力 | ○ | - | あなたの名前は？ |
| 2 | 利用者様のお住まいの施設は？ | ドロップダウン | ○ | 施設リスト | 施設 |
| 3 | 利用者名は？ | ドロップダウン | ○ | 利用者リスト（施設に連動） | ご利用者様のお名前は？ |
| 4 | デイサービスの利用中ですか？ | ラジオボタン | ○ | 利用中 / 利用中ではない | デイ利用有無 |
| 5 | どこのデイサービスですか？ ※条件付き | ドロップダウン | ○※ | デイサービス施設リスト | どこのデイサービスですか？ |
| 6 | 食事はいつのことですか？ | ラジオボタン | ○ | 朝 / 昼 / 夜 | 食事はいつのことですか？ |
| 7 | 主食の摂取量は何割ですか？ | ドロップダウン | - | 0〜10割 | 主食の摂取量は何割ですか？ |
| 8 | 副食の摂取量は何割ですか？ | ドロップダウン | - | 0〜10割 | 副食の摂取量は何割ですか？ |
| 9 | 注入の種類は？ | ドロップダウン | - | 経管栄養の種類リスト | 注入の種類 |
| 10 | 注入量は？ | ドロップダウン | - | cc単位の選択肢 | 注入量は何ccですか？ |
| 11 | 間食は何を食べましたか？ | テキスト入力 | - | 自由記述 | 間食は何を食べましたか？ |
| 12 | 特記事項 | テキストエリア | - | 自由記述（複数行） | 特記事項 |
| 13 | 重要特記事項集計表に反映させますか？ | ラジオボタン | ○ | 重要 / 重要ではない | 重要特記事項集計表に反映させますか？ |
| 14 | 写真アップロード | ファイル選択 | - | 画像ファイル | (Google Drive) |

> ※ フィールド5「どこのデイサービスですか？」は、フィールド4で「利用中」を選択した場合のみ表示される条件付き必須フィールドです。

---

## フィールド詳細

### 1. 入力者（あなた）は？
- **タイプ**: テキスト入力
- **必須**: ○
- **バリデーション**: 空文字不可
- **プレースホルダー**: 「このフィールドを入力してください。」

### 2. 利用者様のお住まいの施設は？
- **タイプ**: ドロップダウン（セレクトボックス）
- **必須**: ○
- **デフォルト**: 「選んでください」
- **選択肢**: 施設マスタから取得（要定義）

### 3. 利用者名は？
- **タイプ**: ドロップダウン（セレクトボックス）
- **必須**: ○
- **デフォルト**: 「選んでください」
- **選択肢**: 施設選択に連動して利用者リストを表示
- **依存関係**: フィールド2の選択後に有効化

### 4. デイサービスの利用中ですか？
- **タイプ**: ラジオボタン
- **必須**: ○
- **選択肢**:
  - 利用中
  - 利用中ではない（デフォルト選択）

### 5. どこのデイサービスですか？ ※条件付き表示
- **タイプ**: ドロップダウン（セレクトボックス）
- **必須**: ○（条件付き必須）
- **表示条件**: フィールド4「デイサービスの利用中ですか？」= 「利用中」
- **デフォルト**: 「選んでください」
- **選択肢**: デイサービス施設リスト（要定義）
- **非表示時**: フィールド4で「利用中ではない」選択時は非表示

### 6. 食事はいつのことですか？
- **タイプ**: ラジオボタン
- **必須**: ○
- **選択肢**:
  - 朝
  - 昼
  - 夜

### 7. 主食の摂取量は何割ですか？
- **タイプ**: ドロップダウン
- **必須**: -
- **デフォルト**: 「選んでください」
- **選択肢**: 0割, 1割, 2割, 3割, 4割, 5割, 6割, 7割, 8割, 9割, 10割（全量）

### 8. 副食の摂取量は何割ですか？
- **タイプ**: ドロップダウン
- **必須**: -
- **デフォルト**: 「選んでください」
- **選択肢**: 0割, 1割, 2割, 3割, 4割, 5割, 6割, 7割, 8割, 9割, 10割（全量）

### 9. 注入の種類は？
- **タイプ**: ドロップダウン
- **必須**: -
- **デフォルト**: 「選んでください」
- **選択肢**: 経管栄養の種類（要定義）

### 10. 注入量は？
- **タイプ**: ドロップダウン
- **必須**: -
- **デフォルト**: 「選んでください」
- **選択肢**: 50cc, 100cc, 150cc, 200cc, 250cc, 300cc, ...（要定義）

### 11. 間食は何を食べましたか？
- **タイプ**: テキスト入力（単一行）
- **必須**: -
- **プレースホルダー**: なし

### 12. 特記事項
- **タイプ**: テキストエリア（複数行）
- **必須**: -
- **プレースホルダー**: 「【ケアに関すること】」「【ACPiece】」のテンプレート表示
- **行数**: 4〜6行程度

### 13. 重要特記事項集計表に反映させますか？
- **タイプ**: ラジオボタン
- **必須**: ○
- **選択肢**:
  - 重要
  - 重要ではない（デフォルト選択）

### 14. 写真アップロード
- **タイプ**: ファイル選択
- **必須**: -
- **許可形式**: 画像ファイル（jpg, png, heic等）
- **保存先**: Google Drive（要実装）

---

## UI/UX設計

### レイアウト
- ヘッダー: 「食事」（濃いグレー背景、白文字）
- フォーム: 縦並びの単一カラムレイアウト
- 送信ボタン: 「送信」（グレー背景）
- フッター: 「トップへ戻る」リンク

### バリデーション
- 必須フィールドの未入力チェック
- 送信時にエラーメッセージ表示
- 送信成功時にトースト通知

### レスポンシブ
- モバイルファースト設計
- タッチターゲット: 44px以上

---

## データフロー

```
[PWAフォーム]
    ↓ 入力・送信
[Cloud Functions: submitCareRecord]
    ↓ 書き込み
[Sheet B: フォームの回答 1]
```

---

## TypeScript型定義（案）

```typescript
interface MealInputForm {
  // 必須フィールド
  staffName: string;           // 入力者（あなた）は？
  facility: string;            // 利用者様のお住まいの施設は？
  residentName: string;        // 利用者名は？
  dayServiceUsage: '利用中' | '利用中ではない';  // デイサービスの利用中ですか？
  mealTime: '朝' | '昼' | '夜'; // 食事はいつのことですか？
  isImportant: '重要' | '重要ではない';  // 重要特記事項集計表に反映させますか？

  // 条件付き必須フィールド
  dayServiceName?: string;     // どこのデイサービスですか？（dayServiceUsage='利用中'の場合必須）

  // 任意フィールド
  mainDishRatio?: string;      // 主食の摂取量は何割ですか？
  sideDishRatio?: string;      // 副食の摂取量は何割ですか？
  injectionType?: string;      // 注入の種類は？
  injectionAmount?: string;    // 注入量は？
  snack?: string;              // 間食は何を食べましたか？
  note?: string;               // 特記事項
  photo?: File;                // 写真アップロード
}
```

---

## 実装優先度

| 優先度 | 項目 | 理由 |
|--------|------|------|
| 高 | フォームUI | 基本機能 |
| 高 | バリデーション | データ品質担保 |
| 中 | 施設・利用者連動 | マスタデータ依存 |
| 中 | ローカル保存 | オフライン対応 |
| 低 | 写真アップロード | Drive権限が必要 |

---

## 未決定事項

1. **施設リスト**: マスタデータの定義が必要
2. **利用者リスト**: 施設ごとの利用者マスタが必要
3. **デイサービスリスト**: デイサービス施設の選択肢定義が必要
4. **注入の種類リスト**: 選択肢の定義が必要
5. **注入量の選択肢**: 刻み幅の定義が必要
6. **写真アップロード**: Google Drive連携の実装方針

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-12-14 | 条件付きフィールド「どこのデイサービスですか？」を追加（14フィールドに拡張） |
| 2025-12-14 | 初版作成（フォーム設計書） |
