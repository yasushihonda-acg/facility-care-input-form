<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>施設ケア入力フォーム - プロジェクト概要</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        .mermaid {
            background: white;
            padding: 1rem;
            border-radius: 0.5rem;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-btn.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
            background-color: #eff6ff;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white py-8">
        <div class="container mx-auto px-4">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">施設ケア入力フォーム</h1>
            <p class="text-lg text-blue-100 mb-6">介護施設向けコミュニケーションアプリ プロトタイプ</p>

            <!-- Quick Access Buttons -->
            <div class="bg-white/10 backdrop-blur rounded-xl p-4">
                <!-- 本番アプリ -->
                <p class="text-sm text-blue-200 mb-2">本番アプリ</p>
                <div class="grid grid-cols-3 gap-3 mb-4">
                    <a href="https://facility-care-input-form.web.app/staff/notes" target="_blank"
                       class="bg-green-500 text-white px-4 py-3 rounded-lg font-semibold hover:bg-green-400 transition text-center text-sm">
                        <span class="block text-2xl mb-1">👨‍⚕️</span>
                        スタッフ用
                    </a>
                    <a href="https://facility-care-input-form.web.app/family" target="_blank"
                       class="bg-pink-500 text-white px-4 py-3 rounded-lg font-semibold hover:bg-pink-400 transition text-center text-sm">
                        <span class="block text-2xl mb-1">👨‍👩‍👧</span>
                        家族用
                    </a>
                    <a href="https://facility-care-input-form.web.app/settings" target="_blank"
                       class="bg-yellow-500 text-black px-4 py-3 rounded-lg font-semibold hover:bg-yellow-400 transition text-center text-sm">
                        <span class="block text-2xl mb-1">⚙️</span>
                        設定
                    </a>
                </div>
                <!-- デモ -->
                <p class="text-sm text-blue-200 mb-2">デモ体験</p>
                <div class="grid grid-cols-2 gap-3">
                    <a href="https://facility-care-input-form.web.app/demo" target="_blank"
                       class="bg-purple-500 text-white px-4 py-3 rounded-lg font-semibold hover:bg-purple-400 transition text-center text-sm">
                        <span class="block text-2xl mb-1">👨‍👩‍👧</span>
                        家族デモ
                    </a>
                    <a href="https://facility-care-input-form.web.app/demo/staff" target="_blank"
                       class="bg-emerald-500 text-white px-4 py-3 rounded-lg font-semibold hover:bg-emerald-400 transition text-center text-sm">
                        <span class="block text-2xl mb-1">👨‍⚕️</span>
                        スタッフデモ
                    </a>
                </div>
                <div class="mt-3 flex gap-3 justify-center flex-wrap">
                    <a href="https://github.com/yasushihonda-acg/facility-care-input-form" target="_blank"
                       class="text-blue-200 hover:text-white text-sm flex items-center gap-1">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
                        GitHub
                    </a>
                    <a href="architecture.html"
                       class="text-blue-200 hover:text-white text-sm flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
                        アーキテクチャ図
                    </a>
                    <a href="tests.html"
                       class="text-blue-200 hover:text-white text-sm flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/></svg>
                        E2Eテスト一覧
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Tab Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-10">
        <div class="container mx-auto px-4">
            <div class="flex overflow-x-auto">
                <button onclick="showTab('overview')" class="tab-btn active flex-shrink-0 px-6 py-4 text-sm font-medium border-b-2 border-transparent hover:bg-gray-50 transition">
                    概要
                </button>
                <button onclick="showTab('features')" class="tab-btn flex-shrink-0 px-6 py-4 text-sm font-medium border-b-2 border-transparent hover:bg-gray-50 transition">
                    機能一覧
                </button>
                <button onclick="showTab('architecture')" class="tab-btn flex-shrink-0 px-6 py-4 text-sm font-medium border-b-2 border-transparent hover:bg-gray-50 transition">
                    システム構成
                </button>
                <button onclick="showTab('progress')" class="tab-btn flex-shrink-0 px-6 py-4 text-sm font-medium border-b-2 border-transparent hover:bg-gray-50 transition">
                    開発進捗
                </button>
                <button onclick="showTab('docs')" class="tab-btn flex-shrink-0 px-6 py-4 text-sm font-medium border-b-2 border-transparent hover:bg-gray-50 transition">
                    ドキュメント
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">

        <!-- Tab: Overview -->
        <div id="tab-overview" class="tab-content active">
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="text-2xl">🎯</span> プロジェクト目的
                    </h2>
                    <p class="text-gray-600 leading-relaxed">
                        介護施設スタッフの食事記録入力と、ご家族への情報共有を実現するプロトタイプアプリケーション。
                        FAXベースのコミュニケーションをデジタル化し、リアルタイムな情報共有を可能にします。
                    </p>
                    <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                        <h3 class="font-semibold text-blue-800 mb-2">主な価値</h3>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>・スタッフの記録入力負荷を軽減</li>
                            <li>・家族がリアルタイムにケア状況を確認</li>
                            <li>・AIによる入力補助で効率化</li>
                        </ul>
                    </div>
                </div>
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="text-2xl">🛠️</span> 技術スタック
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <h3 class="text-sm font-semibold text-gray-500 mb-2">フロントエンド</h3>
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">React</span>
                                <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">TypeScript</span>
                                <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">Vite</span>
                                <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">TailwindCSS</span>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-sm font-semibold text-gray-500 mb-2">バックエンド / インフラ</h3>
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm">Firebase</span>
                                <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">Cloud Functions</span>
                                <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm">Firestore</span>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-sm font-semibold text-gray-500 mb-2">外部連携</h3>
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-emerald-100 text-emerald-800 px-3 py-1 rounded-full text-sm">Google Sheets</span>
                                <span class="bg-cyan-100 text-cyan-800 px-3 py-1 rounded-full text-sm">Firebase Storage</span>
                                <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">Vertex AI (Gemini)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Types -->
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="text-2xl">👥</span> ユーザータイプ別機能
                </h2>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="border-2 border-green-200 rounded-xl p-5 bg-green-50">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-4xl">👨‍⚕️</span>
                            <div>
                                <h3 class="font-bold text-green-800">スタッフ</h3>
                                <p class="text-sm text-green-600">記録入力・閲覧</p>
                            </div>
                        </div>
                        <ul class="text-sm text-green-700 space-y-2">
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>食事・ケア記録の入力</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>写真アップロード</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>タスク管理・リマインダー</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>家族からの連絡確認</span>
                            </li>
                        </ul>
                        <a href="https://facility-care-input-form.web.app/staff/notes" target="_blank"
                           class="mt-4 block text-center bg-green-600 text-white py-2 rounded-lg hover:bg-green-500 transition text-sm font-semibold">
                            スタッフ画面を開く →
                        </a>
                    </div>
                    <div class="border-2 border-pink-200 rounded-xl p-5 bg-pink-50">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-4xl">👨‍👩‍👧</span>
                            <div>
                                <h3 class="font-bold text-pink-800">家族</h3>
                                <p class="text-sm text-pink-600">状況確認・連絡</p>
                            </div>
                        </div>
                        <ul class="text-sm text-pink-700 space-y-2">
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>ケア記録の閲覧</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>品物の送付・在庫管理</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>統計ダッシュボード</span>
                            </li>
                        </ul>
                        <a href="https://facility-care-input-form.web.app/family" target="_blank"
                           class="mt-4 block text-center bg-pink-600 text-white py-2 rounded-lg hover:bg-pink-500 transition text-sm font-semibold">
                            家族画面を開く →
                        </a>
                    </div>
                    <div class="border-2 border-yellow-200 rounded-xl p-5 bg-yellow-50">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-4xl">⚙️</span>
                            <div>
                                <h3 class="font-bold text-yellow-800">管理者</h3>
                                <p class="text-sm text-yellow-600">システム設定</p>
                            </div>
                        </div>
                        <ul class="text-sm text-yellow-700 space-y-2">
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>Webhook URL設定</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>Driveフォルダ設定</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>初期値設定</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <span>✓</span>
                                <span>設定テスト機能</span>
                            </li>
                        </ul>
                        <a href="https://facility-care-input-form.web.app/settings" target="_blank"
                           class="mt-4 block text-center bg-yellow-600 text-white py-2 rounded-lg hover:bg-yellow-500 transition text-sm font-semibold">
                            設定画面を開く →
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Features -->
        <div id="tab-features" class="tab-content">
            <!-- Feature Categories -->
            <div class="space-y-8">
                <!-- Core Features -->
                <div>
                    <h2 class="text-lg font-bold text-gray-700 mb-4 flex items-center gap-2">
                        <span class="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm">1</span>
                        コア機能
                    </h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">📋</div>
                            <h3 class="font-semibold mb-1">記録閲覧</h3>
                            <p class="text-gray-600 text-sm">スプレッドシートから自動同期されたケア記録をタブ形式で閲覧。検索・ソート機能付き。</p>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">🍪</div>
                            <h3 class="font-semibold mb-1">間食記録フォーム</h3>
                            <p class="text-gray-600 text-sm">スタッフが間食（家族からの差し入れ）の提供記録を入力。写真アップロード、Google Chat通知に対応。</p>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">👨‍👩‍👧</div>
                            <h3 class="font-semibold mb-1">家族ビュー</h3>
                            <p class="text-gray-600 text-sm">ご家族向けのタイムライン表示。品物の送付・提供履歴を確認。</p>
                        </div>
                    </div>
                </div>

                <!-- Integration Features -->
                <div>
                    <h2 class="text-lg font-bold text-gray-700 mb-4 flex items-center gap-2">
                        <span class="w-8 h-8 bg-indigo-500 text-white rounded-full flex items-center justify-center text-sm">2</span>
                        連携機能
                    </h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">💬</div>
                            <h3 class="font-semibold mb-1">Google Chat通知</h3>
                            <p class="text-gray-600 text-sm">食事記録入力時にWebhookで自動通知。重要フラグ付きは別チャンネルにも通知。</p>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">📷</div>
                            <h3 class="font-semibold mb-1">写真アップロード</h3>
                            <p class="text-gray-600 text-sm">Firebase Storageへの画像保存。設定不要で自動的にクラウドに保存。</p>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">🧪</div>
                            <h3 class="font-semibold mb-1">設定テスト機能</h3>
                            <p class="text-gray-600 text-sm">Webhook URLの設定を保存前にテスト。親切なエラーメッセージ付き。</p>
                        </div>
                    </div>
                </div>

                <!-- Phase 8 Features -->
                <div>
                    <h2 class="text-lg font-bold text-gray-700 mb-4 flex items-center gap-2">
                        <span class="w-8 h-8 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm">3</span>
                        Phase 8 新機能
                    </h2>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-purple-500">
                            <div class="text-2xl mb-2">📦</div>
                            <h3 class="font-semibold mb-1">品物管理</h3>
                            <p class="text-gray-600 text-sm">家族が送付した品物の登録・追跡。賞味期限・在庫管理、提供・摂食記録。</p>
                            <span class="inline-block mt-2 bg-purple-100 text-purple-700 px-2 py-0.5 rounded text-xs">Phase 8.1</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-purple-500">
                            <div class="text-2xl mb-2">✅</div>
                            <h3 class="font-semibold mb-1">タスク管理</h3>
                            <p class="text-gray-600 text-sm">スタッフ向けタスク管理。賞味期限警告・提供リマインダーを毎日自動生成。</p>
                            <span class="inline-block mt-2 bg-purple-100 text-purple-700 px-2 py-0.5 rounded text-xs">Phase 8.2</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-purple-500">
                            <div class="text-2xl mb-2">📊</div>
                            <h3 class="font-semibold mb-1">統計ダッシュボード</h3>
                            <p class="text-gray-600 text-sm">品物状況・アラートを可視化。スタッフ・家族共通ビューで認識のズレを防止。</p>
                            <span class="inline-block mt-2 bg-purple-100 text-purple-700 px-2 py-0.5 rounded text-xs">Phase 8.3</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-purple-500">
                            <div class="text-2xl mb-2">🤖</div>
                            <h3 class="font-semibold mb-1">Gemini AI連携</h3>
                            <p class="text-gray-600 text-sm">品物入力補助 + 摂食傾向分析 + 品物名正規化（Flash Lite）。</p>
                            <span class="inline-block mt-2 bg-purple-100 text-purple-700 px-2 py-0.5 rounded text-xs">Phase 8.4/43.1</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-purple-500">
                            <div class="text-2xl mb-2">📌</div>
                            <h3 class="font-semibold mb-1">プリセット管理</h3>
                            <p class="text-gray-600 text-sm">「いつもの指示」の登録・管理。品物登録時にワンクリックでプリセット保存。</p>
                            <span class="inline-block mt-2 bg-purple-100 text-purple-700 px-2 py-0.5 rounded text-xs">Phase 8.6/8.7</span>
                        </div>
                    </div>
                </div>

                <!-- Phase 9 Features -->
                <div>
                    <h2 class="text-lg font-bold text-gray-700 mb-4 flex items-center gap-2">
                        <span class="w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center text-sm">4</span>
                        Phase 9 新機能
                    </h2>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">🗂️</div>
                            <h3 class="font-semibold mb-1">ビュー構成設計</h3>
                            <p class="text-gray-600 text-sm">スタッフ/家族別ビュー分離。共有ページとロール別ページの整理。</p>
                            <span class="inline-block mt-2 bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs">Phase 9.0 ✅完了</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">🔀</div>
                            <h3 class="font-semibold mb-1">ルーティング実装</h3>
                            <p class="text-gray-600 text-sm">品物タイムライン、スタッフ/家族ナビゲーション、共有ビューの実装。</p>
                            <span class="inline-block mt-2 bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs">Phase 9.1 ✅完了</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">📝</div>
                            <h3 class="font-semibold mb-1">消費記録連携</h3>
                            <p class="text-gray-600 text-sm">提供・摂食記録API、在庫バー表示、タイムラインとの連携。</p>
                            <span class="inline-block mt-2 bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs">Phase 9.2 ✅完了</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                            <div class="text-2xl mb-2">🚫</div>
                            <h3 class="font-semibold mb-1">禁止ルール機能</h3>
                            <p class="text-gray-600 text-sm">家族が設定した提供禁止品目をスタッフに警告表示。入居者設定画面で管理。</p>
                            <span class="inline-block mt-2 bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs">Phase 9.x ✅完了</span>
                        </div>
                    </div>
                </div>

                <!-- Phase 16-19 Features -->
                <div>
                    <h2 class="text-lg font-bold text-gray-700 mb-4 flex items-center gap-2">
                        <span class="w-8 h-8 bg-pink-500 text-white rounded-full flex items-center justify-center text-sm">5</span>
                        Phase 16-19 新機能
                    </h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-pink-500">
                            <div class="text-2xl mb-2">📸</div>
                            <h3 class="font-semibold mb-1">写真エビデンス表示</h3>
                            <p class="text-gray-600 text-sm">タイムラインにケア写真を表示。家族が摂食状況を視覚的に確認可能。</p>
                            <span class="inline-block mt-2 bg-pink-100 text-pink-700 px-2 py-0.5 rounded text-xs">Phase 16 ✅完了</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-pink-500">
                            <div class="text-2xl mb-2">☁️</div>
                            <h3 class="font-semibold mb-1">Firebase Storage連携</h3>
                            <p class="text-gray-600 text-sm">写真をFirebase Storageに移行。Cloud FunctionsのAPIで安全に配信。</p>
                            <span class="inline-block mt-2 bg-pink-100 text-pink-700 px-2 py-0.5 rounded text-xs">Phase 17 ✅完了</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-pink-500">
                            <div class="text-2xl mb-2">💬</div>
                            <h3 class="font-semibold mb-1">チャット連携</h3>
                            <p class="text-gray-600 text-sm">品物起点でスタッフ・家族間のメッセージ機能。未読バッジ付きで通知。</p>
                            <span class="inline-block mt-2 bg-pink-100 text-pink-700 px-2 py-0.5 rounded text-xs">Phase 18 ✅完了</span>
                        </div>
                        <div class="bg-white rounded-lg shadow p-5 border-l-4 border-pink-500">
                            <div class="text-2xl mb-2">🔔</div>
                            <h3 class="font-semibold mb-1">記録のチャット連携</h3>
                            <p class="text-gray-600 text-sm">スタッフ記録入力時の自動通知、ホーム画面への通知セクション表示。</p>
                            <span class="inline-block mt-2 bg-pink-100 text-pink-700 px-2 py-0.5 rounded text-xs">Phase 19 ✅完了</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Architecture -->
        <div id="tab-architecture" class="tab-content">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="text-2xl">🏗️</span> システムデータフロー
                </h2>
                <div class="overflow-x-auto">
                    <div class="mermaid">
flowchart TB
    subgraph External[外部サービス]
        SheetA[Sheet A - 記録の結果]
        SheetB[Sheet B - 実績入力]
        Storage[Firebase Storage - 写真保存]
        GChat[Google Chat - Webhook]
        Gemini[Vertex AI - Gemini]
    end

    subgraph Backend[Cloud Functions]
        Sync[syncPlanData]
        Get[getPlanData]
        Submit[submitMealRecord]
        Upload[uploadCareImage]
        CareItems[submitCareItem]
        Tasks[getTasks]
        Stats[getStats]
        AISuggest[aiSuggest]
        TaskGen[generateDailyTasks]
    end

    subgraph Storage[Firestore]
        PlanData[plan_data]
        Settings[settings]
        CareItemsDB[care_items]
        TasksDB[tasks]
    end

    subgraph Frontend[React PWA]
        Home[記録閲覧]
        Input[食事入力]
        Family[家族ビュー]
        Items[品物管理]
        Dashboard[統計]
    end

    SheetA --> Sync
    Sync --> PlanData
    PlanData --> Get
    Get --> Home
    Get --> Family

    Input --> Submit
    Submit --> SheetB
    Submit --> GChat

    Input --> Upload
    Upload --> Storage

    Items --> CareItems
    CareItems --> CareItemsDB
    CareItems --> AISuggest
    AISuggest --> Gemini

    TaskGen --> CareItemsDB
    TaskGen --> TasksDB
    Tasks --> TasksDB
    Tasks --> Dashboard

    Stats --> CareItemsDB
    Stats --> Dashboard

    Settings -.-> Submit
    Settings -.-> Upload
                    </div>
                </div>
                <div class="mt-6 text-center">
                    <a href="architecture.html" class="inline-flex items-center gap-2 bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-500 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
                        詳細なアーキテクチャ図を見る
                    </a>
                </div>
            </div>
        </div>

        <!-- Tab: Progress -->
        <div id="tab-progress" class="tab-content">
            <div class="bg-white rounded-xl shadow-md p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="text-2xl">📈</span> 開発進捗
                </h2>

                <!-- Summary -->
                <div class="bg-green-50 rounded-lg p-4 mb-6">
                    <div class="flex items-center justify-between mb-2">
                        <span class="font-bold text-green-800">Phase 1〜48 完了</span>
                        <span class="bg-green-600 text-white px-3 py-1 rounded-full text-sm font-medium">100%</span>
                    </div>
                    <p class="text-sm text-green-700">E2Eテスト: 424件定義</p>
                </div>

                <!-- Major Milestones -->
                <div class="space-y-4">
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 1-9: コア機能</h3>
                        <p class="text-sm text-gray-500">Firebase基盤、PWA、食事入力、家族ビュー、品物管理、AI連携、在庫追跡</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 10-15: 統合機能</h3>
                        <p class="text-sm text-gray-500">間食記録連携、FoodMasterキャッシュ、FIFO、スケジュール、スタッフデモ</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 16-19: 写真・チャット</h3>
                        <p class="text-sm text-gray-500">Firebase Storage、写真エビデンス、チャット連携、通知</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 20-40: 改善・最適化</h3>
                        <p class="text-sm text-gray-500">デモ最適化、編集機能、水分記録、通知、カテゴリ簡素化、AI分析、品物管理リデザイン、間食記録タブUI、ロール別テーマ整理、スタッフ注意事項機能</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 41-43: プリセット・統計改善</h3>
                        <p class="text-sm text-gray-500">プリセット整備、残り対応タブ、品物名正規化AI（Gemini 2.5 Flash Lite）</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 44-45: プリセット編集・AIチャット</h3>
                        <p class="text-sm text-gray-500">品物登録からプリセット編集、記録閲覧AIチャットボット（plan_dataをRAGコンテキスト）</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 46-47: RAG品質・UI強化</h3>
                        <p class="text-sm text-gray-500">階層的要約システム（日次/週次/月次）、AIチャットMarkdownレンダリング（テーブル・箇条書き対応）</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 48: 記録閲覧機能拡張</h3>
                        <p class="text-sm text-gray-500">グラフタブ（バイタル/排泄/体重/水分）、相関分析タブ（マグミット×排便相関率）、年月タブsticky固定、モバイル最適化</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-semibold text-gray-800">Phase 49: 廃棄指示フロー</h3>
                        <p class="text-sm text-gray-500">家族→スタッフ廃棄依頼（pending_discard）、注意事項ページにバッジ表示、廃棄完了ボタン</p>
                    </div>
                </div>

                <!-- Detail Link -->
                <div class="mt-6 pt-4 border-t border-gray-200">
                    <p class="text-sm text-gray-500">
                        詳細な開発履歴は <code class="bg-gray-100 px-2 py-0.5 rounded">git log</code> または
                        <a href="https://github.com/yasushihonda-acg/facility-care-input-form/tree/main/docs/archive" target="_blank" class="text-blue-600 hover:underline">docs/archive/</a> を参照
                    </p>
                </div>
            </div>
        </div>

        <!-- Tab: Documents -->
        <div id="tab-docs" class="tab-content">
            <div class="space-y-6">
                <!-- Active Docs -->
                <div>
                    <h2 class="text-lg font-bold text-gray-700 mb-4 flex items-center gap-2">
                        <span class="text-green-500">📄</span> アクティブドキュメント
                    </h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        <a href="https://github.com/yasushihonda-acg/facility-care-input-form/blob/main/docs/HANDOVER.md" target="_blank"
                           class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition border-l-4 border-red-500 group">
                            <h3 class="font-semibold text-gray-800 group-hover:text-red-600">HANDOVER.md</h3>
                            <p class="text-sm text-gray-600">引き継ぎドキュメント（クイックスタート）</p>
                        </a>
                        <a href="https://github.com/yasushihonda-acg/facility-care-input-form/blob/main/docs/ARCHITECTURE.md" target="_blank"
                           class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition border-l-4 border-blue-500 group">
                            <h3 class="font-semibold text-gray-800 group-hover:text-blue-600">ARCHITECTURE.md</h3>
                            <p class="text-sm text-gray-600">システム設計・データフロー</p>
                        </a>
                        <a href="https://github.com/yasushihonda-acg/facility-care-input-form/blob/main/docs/API_SPEC.md" target="_blank"
                           class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition border-l-4 border-orange-500 group">
                            <h3 class="font-semibold text-gray-800 group-hover:text-orange-600">API_SPEC.md</h3>
                            <p class="text-sm text-gray-600">API仕様書（全エンドポイント）</p>
                        </a>
                        <a href="https://github.com/yasushihonda-acg/facility-care-input-form/blob/main/docs/BUSINESS_RULES.md" target="_blank"
                           class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition border-l-4 border-purple-500 group">
                            <h3 class="font-semibold text-gray-800 group-hover:text-purple-600">BUSINESS_RULES.md</h3>
                            <p class="text-sm text-gray-600">業務ルール・投稿ID規則</p>
                        </a>
                        <a href="https://github.com/yasushihonda-acg/facility-care-input-form/blob/main/docs/DATA_MODEL.md" target="_blank"
                           class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition border-l-4 border-teal-500 group">
                            <h3 class="font-semibold text-gray-800 group-hover:text-teal-600">DATA_MODEL.md</h3>
                            <p class="text-sm text-gray-600">データモデル・Firestore構造</p>
                        </a>
                        <a href="https://github.com/yasushihonda-acg/facility-care-input-form/blob/main/docs/SETUP.md" target="_blank"
                           class="bg-white rounded-lg shadow p-4 hover:shadow-lg transition border-l-4 border-green-500 group">
                            <h3 class="font-semibold text-gray-800 group-hover:text-green-600">SETUP.md</h3>
                            <p class="text-sm text-gray-600">環境構築ガイド</p>
                        </a>
                    </div>
                </div>

                <!-- Archive Info -->
                <div class="bg-gray-100 rounded-lg p-4">
                    <h2 class="text-lg font-bold text-gray-700 mb-2 flex items-center gap-2">
                        <span class="text-gray-500">📁</span> アーカイブ
                    </h2>
                    <p class="text-sm text-gray-600 mb-3">
                        参照用ファイル（シート構造・同期仕様等）は <code class="bg-white px-2 py-0.5 rounded">docs/archive/</code> に保存されています。
                    </p>
                    <a href="https://github.com/yasushihonda-acg/facility-care-input-form/tree/main/docs/archive" target="_blank"
                       class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 text-sm">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
                        アーカイブを見る（GitHub）
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto px-4 text-center">
            <p class="text-gray-400">
                © 2025 施設ケア入力フォーム プロジェクト
            </p>
            <p class="text-gray-500 text-sm mt-2">
                最終更新: 2026年1月1日（Phase 49完了・E2Eテスト424件）
            </p>
        </div>
    </footer>

    <script>
        // Mermaid initialization - startOnLoad: false for tab control
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: false
            }
        });

        let mermaidRendered = false;

        // Tab switching
        function showTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(el => {
                el.classList.remove('active');
            });
            // Deactivate all tab buttons
            document.querySelectorAll('.tab-btn').forEach(el => {
                el.classList.remove('active');
            });
            // Show selected tab content
            document.getElementById('tab-' + tabId).classList.add('active');
            // Activate selected tab button
            event.currentTarget.classList.add('active');

            // Render Mermaid when architecture tab is shown (only once)
            if (tabId === 'architecture' && !mermaidRendered) {
                mermaidRendered = true;
                setTimeout(() => {
                    mermaid.run({
                        nodes: document.querySelectorAll('.mermaid')
                    });
                }, 100);
            }
        }
    </script>
</body>
</html>
